(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict"},{}],2:[function(require,module,exports){"use strict";var bind=require("function-bind");var $apply=require("./functionApply");var $call=require("./functionCall");var $reflectApply=require("./reflectApply");module.exports=$reflectApply||bind.call($call,$apply)},{"./functionApply":3,"./functionCall":4,"./reflectApply":6,"function-bind":20}],3:[function(require,module,exports){"use strict";module.exports=Function.prototype.apply},{}],4:[function(require,module,exports){"use strict";module.exports=Function.prototype.call},{}],5:[function(require,module,exports){"use strict";var bind=require("function-bind");var $TypeError=require("es-errors/type");var $call=require("./functionCall");var $actualApply=require("./actualApply");module.exports=function callBindBasic(args){if(args.length<1||typeof args[0]!=="function"){throw new $TypeError("a function is required")}return $actualApply(bind,$call,args)}},{"./actualApply":2,"./functionCall":4,"es-errors/type":16,"function-bind":20}],6:[function(require,module,exports){"use strict";module.exports=typeof Reflect!=="undefined"&&Reflect&&Reflect.apply},{}],7:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBindBasic=require("call-bind-apply-helpers");var $indexOf=callBindBasic([GetIntrinsic("%String.prototype.indexOf%")]);module.exports=function callBoundIntrinsic(name,allowMissing){var intrinsic=GetIntrinsic(name,!!allowMissing);if(typeof intrinsic==="function"&&$indexOf(name,".prototype.")>-1){return callBindBasic([intrinsic])}return intrinsic}},{"call-bind-apply-helpers":5,"get-intrinsic":21}],8:[function(require,module,exports){"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n=0,F=function F(){};return{s:F,n:function n(){return _n>=r.length?{done:!0}:{done:!1,value:r[_n++]}},e:function e(r){throw r},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function s(){t=t.call(r)},n:function n(){var r=t.next();return a=r.done,r},e:function e(r){u=!0,o=r},f:function f(){try{a||null==t["return"]||t["return"]()}finally{if(u)throw o}}}}function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,e);var p=new(t.bind.apply(t,o));return r&&_setPrototypeOf(p,r.prototype),p}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}(function(global,factory){(typeof exports==="undefined"?"undefined":_typeof(exports))==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):(global=typeof globalThis!=="undefined"?globalThis:global||self,global.DOMPurify=factory())})(void 0,function(){"use strict";var entries=Object.entries,setPrototypeOf=Object.setPrototypeOf,isFrozen=Object.isFrozen,getPrototypeOf=Object.getPrototypeOf,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;var freeze=Object.freeze,seal=Object.seal,create=Object.create;var _ref=typeof Reflect!=="undefined"&&Reflect,apply=_ref.apply,construct=_ref.construct;if(!freeze){freeze=function freeze(x){return x}}if(!seal){seal=function seal(x){return x}}if(!apply){apply=function apply(fun,thisValue,args){return fun.apply(thisValue,args)}}if(!construct){construct=function construct(Func,args){return _construct(Func,_toConsumableArray(args))}}var arrayForEach=unapply(Array.prototype.forEach);var arrayPop=unapply(Array.prototype.pop);var arrayPush=unapply(Array.prototype.push);var stringToLowerCase=unapply(String.prototype.toLowerCase);var stringToString=unapply(String.prototype.toString);var stringMatch=unapply(String.prototype.match);var stringReplace=unapply(String.prototype.replace);var stringIndexOf=unapply(String.prototype.indexOf);var stringTrim=unapply(String.prototype.trim);var objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty);var regExpTest=unapply(RegExp.prototype.test);var typeErrorCreate=unconstruct(TypeError);function unapply(func){return function(thisArg){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}return apply(func,thisArg,args)}}function unconstruct(func){return function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}return construct(func,args)}}function addToSet(set,array){var transformCaseFunc=arguments.length>2&&arguments[2]!==undefined?arguments[2]:stringToLowerCase;if(setPrototypeOf){setPrototypeOf(set,null)}var l=array.length;while(l--){var element=array[l];if(typeof element==="string"){var lcElement=transformCaseFunc(element);if(lcElement!==element){if(!isFrozen(array)){array[l]=lcElement}element=lcElement}}set[element]=true}return set}function cleanArray(array){for(var index=0;index<array.length;index++){var isPropertyExist=objectHasOwnProperty(array,index);if(!isPropertyExist){array[index]=null}}return array}function clone(object){var newObject=create(null);var _iterator=_createForOfIteratorHelper(entries(object)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),property=_step$value[0],value=_step$value[1];var isPropertyExist=objectHasOwnProperty(object,property);if(isPropertyExist){if(Array.isArray(value)){newObject[property]=cleanArray(value)}else if(value&&_typeof(value)==="object"&&value.constructor===Object){newObject[property]=clone(value)}else{newObject[property]=value}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return newObject}function lookupGetter(object,prop){while(object!==null){var desc=getOwnPropertyDescriptor(object,prop);if(desc){if(desc.get){return unapply(desc.get)}if(typeof desc.value==="function"){return unapply(desc.value)}}object=getPrototypeOf(object)}function fallbackValue(){return null}return fallbackValue}var html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]);var svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]);var svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]);var svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]);var mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]);var mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]);var text=freeze(["#text"]);var html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]);var svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]);var mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]);var xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]);var MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm);var ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm);var TMPLIT_EXPR=seal(/\$\{[\w\W]*}/gm);var DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/);var ARIA_ATTR=seal(/^aria-[\-\w]+$/);var IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i);var IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i);var ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g);var DOCTYPE_NAME=seal(/^html$/i);var CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR:ARIA_ATTR,ATTR_WHITESPACE:ATTR_WHITESPACE,CUSTOM_ELEMENT:CUSTOM_ELEMENT,DATA_ATTR:DATA_ATTR,DOCTYPE_NAME:DOCTYPE_NAME,ERB_EXPR:ERB_EXPR,IS_ALLOWED_URI:IS_ALLOWED_URI,IS_SCRIPT_OR_DATA:IS_SCRIPT_OR_DATA,MUSTACHE_EXPR:MUSTACHE_EXPR,TMPLIT_EXPR:TMPLIT_EXPR});var NODE_TYPE={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12};var getGlobal=function getGlobal(){return typeof window==="undefined"?null:window};var _createTrustedTypesPolicy=function _createTrustedTypesPolicy(trustedTypes,purifyHostElement){if(_typeof(trustedTypes)!=="object"||typeof trustedTypes.createPolicy!=="function"){return null}var suffix=null;var ATTR_NAME="data-tt-policy-suffix";if(purifyHostElement&&purifyHostElement.hasAttribute(ATTR_NAME)){suffix=purifyHostElement.getAttribute(ATTR_NAME)}var policyName="dompurify"+(suffix?"#"+suffix:"");try{return trustedTypes.createPolicy(policyName,{createHTML:function createHTML(html){return html},createScriptURL:function createScriptURL(scriptUrl){return scriptUrl}})}catch(_){console.warn("TrustedTypes policy "+policyName+" could not be created.");return null}};var _createHooksMap=function _createHooksMap(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){var window=arguments.length>0&&arguments[0]!==undefined?arguments[0]:getGlobal();var DOMPurify=function DOMPurify(root){return createDOMPurify(root)};DOMPurify.version="3.2.3";DOMPurify.removed=[];if(!window||!window.document||window.document.nodeType!==NODE_TYPE.document){DOMPurify.isSupported=false;return DOMPurify}var document=window.document;var originalDocument=document;var currentScript=originalDocument.currentScript;var DocumentFragment=window.DocumentFragment,HTMLTemplateElement=window.HTMLTemplateElement,Node=window.Node,Element=window.Element,NodeFilter=window.NodeFilter,_window$NamedNodeMap=window.NamedNodeMap,NamedNodeMap=_window$NamedNodeMap===void 0?window.NamedNodeMap||window.MozNamedAttrMap:_window$NamedNodeMap,HTMLFormElement=window.HTMLFormElement,DOMParser=window.DOMParser,trustedTypes=window.trustedTypes;var ElementPrototype=Element.prototype;var cloneNode=lookupGetter(ElementPrototype,"cloneNode");var remove=lookupGetter(ElementPrototype,"remove");var getNextSibling=lookupGetter(ElementPrototype,"nextSibling");var getChildNodes=lookupGetter(ElementPrototype,"childNodes");var getParentNode=lookupGetter(ElementPrototype,"parentNode");if(typeof HTMLTemplateElement==="function"){var template=document.createElement("template");if(template.content&&template.content.ownerDocument){document=template.content.ownerDocument}}var trustedTypesPolicy;var emptyHTML="";var _document=document,implementation=_document.implementation,createNodeIterator=_document.createNodeIterator,createDocumentFragment=_document.createDocumentFragment,getElementsByTagName=_document.getElementsByTagName;var importNode=originalDocument.importNode;var hooks=_createHooksMap();DOMPurify.isSupported=typeof entries==="function"&&typeof getParentNode==="function"&&implementation&&implementation.createHTMLDocument!==undefined;var MUSTACHE_EXPR=EXPRESSIONS.MUSTACHE_EXPR,ERB_EXPR=EXPRESSIONS.ERB_EXPR,TMPLIT_EXPR=EXPRESSIONS.TMPLIT_EXPR,DATA_ATTR=EXPRESSIONS.DATA_ATTR,ARIA_ATTR=EXPRESSIONS.ARIA_ATTR,IS_SCRIPT_OR_DATA=EXPRESSIONS.IS_SCRIPT_OR_DATA,ATTR_WHITESPACE=EXPRESSIONS.ATTR_WHITESPACE,CUSTOM_ELEMENT=EXPRESSIONS.CUSTOM_ELEMENT;var IS_ALLOWED_URI$1=EXPRESSIONS.IS_ALLOWED_URI;var ALLOWED_TAGS=null;var DEFAULT_ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray(html$1),_toConsumableArray(svg$1),_toConsumableArray(svgFilters),_toConsumableArray(mathMl$1),_toConsumableArray(text)));var ALLOWED_ATTR=null;var DEFAULT_ALLOWED_ATTR=addToSet({},[].concat(_toConsumableArray(html),_toConsumableArray(svg),_toConsumableArray(mathMl),_toConsumableArray(xml)));var CUSTOM_ELEMENT_HANDLING=Object.seal(create(null,{tagNameCheck:{writable:true,configurable:false,enumerable:true,value:null},attributeNameCheck:{writable:true,configurable:false,enumerable:true,value:null},allowCustomizedBuiltInElements:{writable:true,configurable:false,enumerable:true,value:false}}));var FORBID_TAGS=null;var FORBID_ATTR=null;var ALLOW_ARIA_ATTR=true;var ALLOW_DATA_ATTR=true;var ALLOW_UNKNOWN_PROTOCOLS=false;var ALLOW_SELF_CLOSE_IN_ATTR=true;var SAFE_FOR_TEMPLATES=false;var SAFE_FOR_XML=true;var WHOLE_DOCUMENT=false;var SET_CONFIG=false;var FORCE_BODY=false;var RETURN_DOM=false;var RETURN_DOM_FRAGMENT=false;var RETURN_TRUSTED_TYPE=false;var SANITIZE_DOM=true;var SANITIZE_NAMED_PROPS=false;var SANITIZE_NAMED_PROPS_PREFIX="user-content-";var KEEP_CONTENT=true;var IN_PLACE=false;var USE_PROFILES={};var FORBID_CONTENTS=null;var DEFAULT_FORBID_CONTENTS=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);var DATA_URI_TAGS=null;var DEFAULT_DATA_URI_TAGS=addToSet({},["audio","video","img","source","image","track"]);var URI_SAFE_ATTRIBUTES=null;var DEFAULT_URI_SAFE_ATTRIBUTES=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]);var MATHML_NAMESPACE="http://www.w3.org/1998/Math/MathML";var SVG_NAMESPACE="http://www.w3.org/2000/svg";var HTML_NAMESPACE="http://www.w3.org/1999/xhtml";var NAMESPACE=HTML_NAMESPACE;var IS_EMPTY_INPUT=false;var ALLOWED_NAMESPACES=null;var DEFAULT_ALLOWED_NAMESPACES=addToSet({},[MATHML_NAMESPACE,SVG_NAMESPACE,HTML_NAMESPACE],stringToString);var MATHML_TEXT_INTEGRATION_POINTS=addToSet({},["mi","mo","mn","ms","mtext"]);var HTML_INTEGRATION_POINTS=addToSet({},["annotation-xml"]);var COMMON_SVG_AND_HTML_ELEMENTS=addToSet({},["title","style","font","a","script"]);var PARSER_MEDIA_TYPE=null;var SUPPORTED_PARSER_MEDIA_TYPES=["application/xhtml+xml","text/html"];var DEFAULT_PARSER_MEDIA_TYPE="text/html";var transformCaseFunc=null;var CONFIG=null;var formElement=document.createElement("form");var isRegexOrFunction=function isRegexOrFunction(testValue){return testValue instanceof RegExp||testValue instanceof Function};var _parseConfig=function _parseConfig(){var cfg=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(CONFIG&&CONFIG===cfg){return}if(!cfg||_typeof(cfg)!=="object"){cfg={}}cfg=clone(cfg);PARSER_MEDIA_TYPE=SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE)===-1?DEFAULT_PARSER_MEDIA_TYPE:cfg.PARSER_MEDIA_TYPE;transformCaseFunc=PARSER_MEDIA_TYPE==="application/xhtml+xml"?stringToString:stringToLowerCase;ALLOWED_TAGS=objectHasOwnProperty(cfg,"ALLOWED_TAGS")?addToSet({},cfg.ALLOWED_TAGS,transformCaseFunc):DEFAULT_ALLOWED_TAGS;ALLOWED_ATTR=objectHasOwnProperty(cfg,"ALLOWED_ATTR")?addToSet({},cfg.ALLOWED_ATTR,transformCaseFunc):DEFAULT_ALLOWED_ATTR;ALLOWED_NAMESPACES=objectHasOwnProperty(cfg,"ALLOWED_NAMESPACES")?addToSet({},cfg.ALLOWED_NAMESPACES,stringToString):DEFAULT_ALLOWED_NAMESPACES;URI_SAFE_ATTRIBUTES=objectHasOwnProperty(cfg,"ADD_URI_SAFE_ATTR")?addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES),cfg.ADD_URI_SAFE_ATTR,transformCaseFunc):DEFAULT_URI_SAFE_ATTRIBUTES;DATA_URI_TAGS=objectHasOwnProperty(cfg,"ADD_DATA_URI_TAGS")?addToSet(clone(DEFAULT_DATA_URI_TAGS),cfg.ADD_DATA_URI_TAGS,transformCaseFunc):DEFAULT_DATA_URI_TAGS;FORBID_CONTENTS=objectHasOwnProperty(cfg,"FORBID_CONTENTS")?addToSet({},cfg.FORBID_CONTENTS,transformCaseFunc):DEFAULT_FORBID_CONTENTS;FORBID_TAGS=objectHasOwnProperty(cfg,"FORBID_TAGS")?addToSet({},cfg.FORBID_TAGS,transformCaseFunc):{};FORBID_ATTR=objectHasOwnProperty(cfg,"FORBID_ATTR")?addToSet({},cfg.FORBID_ATTR,transformCaseFunc):{};USE_PROFILES=objectHasOwnProperty(cfg,"USE_PROFILES")?cfg.USE_PROFILES:false;ALLOW_ARIA_ATTR=cfg.ALLOW_ARIA_ATTR!==false;ALLOW_DATA_ATTR=cfg.ALLOW_DATA_ATTR!==false;ALLOW_UNKNOWN_PROTOCOLS=cfg.ALLOW_UNKNOWN_PROTOCOLS||false;ALLOW_SELF_CLOSE_IN_ATTR=cfg.ALLOW_SELF_CLOSE_IN_ATTR!==false;SAFE_FOR_TEMPLATES=cfg.SAFE_FOR_TEMPLATES||false;SAFE_FOR_XML=cfg.SAFE_FOR_XML!==false;WHOLE_DOCUMENT=cfg.WHOLE_DOCUMENT||false;RETURN_DOM=cfg.RETURN_DOM||false;RETURN_DOM_FRAGMENT=cfg.RETURN_DOM_FRAGMENT||false;RETURN_TRUSTED_TYPE=cfg.RETURN_TRUSTED_TYPE||false;FORCE_BODY=cfg.FORCE_BODY||false;SANITIZE_DOM=cfg.SANITIZE_DOM!==false;SANITIZE_NAMED_PROPS=cfg.SANITIZE_NAMED_PROPS||false;KEEP_CONTENT=cfg.KEEP_CONTENT!==false;IN_PLACE=cfg.IN_PLACE||false;IS_ALLOWED_URI$1=cfg.ALLOWED_URI_REGEXP||IS_ALLOWED_URI;NAMESPACE=cfg.NAMESPACE||HTML_NAMESPACE;MATHML_TEXT_INTEGRATION_POINTS=cfg.MATHML_TEXT_INTEGRATION_POINTS||MATHML_TEXT_INTEGRATION_POINTS;HTML_INTEGRATION_POINTS=cfg.HTML_INTEGRATION_POINTS||HTML_INTEGRATION_POINTS;CUSTOM_ELEMENT_HANDLING=cfg.CUSTOM_ELEMENT_HANDLING||{};if(cfg.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)){CUSTOM_ELEMENT_HANDLING.tagNameCheck=cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck}if(cfg.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)){CUSTOM_ELEMENT_HANDLING.attributeNameCheck=cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck}if(cfg.CUSTOM_ELEMENT_HANDLING&&typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements==="boolean"){CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements}if(SAFE_FOR_TEMPLATES){ALLOW_DATA_ATTR=false}if(RETURN_DOM_FRAGMENT){RETURN_DOM=true}if(USE_PROFILES){ALLOWED_TAGS=addToSet({},text);ALLOWED_ATTR=[];if(USE_PROFILES.html===true){addToSet(ALLOWED_TAGS,html$1);addToSet(ALLOWED_ATTR,html)}if(USE_PROFILES.svg===true){addToSet(ALLOWED_TAGS,svg$1);addToSet(ALLOWED_ATTR,svg);addToSet(ALLOWED_ATTR,xml)}if(USE_PROFILES.svgFilters===true){addToSet(ALLOWED_TAGS,svgFilters);addToSet(ALLOWED_ATTR,svg);addToSet(ALLOWED_ATTR,xml)}if(USE_PROFILES.mathMl===true){addToSet(ALLOWED_TAGS,mathMl$1);addToSet(ALLOWED_ATTR,mathMl);addToSet(ALLOWED_ATTR,xml)}}if(cfg.ADD_TAGS){if(ALLOWED_TAGS===DEFAULT_ALLOWED_TAGS){ALLOWED_TAGS=clone(ALLOWED_TAGS)}addToSet(ALLOWED_TAGS,cfg.ADD_TAGS,transformCaseFunc)}if(cfg.ADD_ATTR){if(ALLOWED_ATTR===DEFAULT_ALLOWED_ATTR){ALLOWED_ATTR=clone(ALLOWED_ATTR)}addToSet(ALLOWED_ATTR,cfg.ADD_ATTR,transformCaseFunc)}if(cfg.ADD_URI_SAFE_ATTR){addToSet(URI_SAFE_ATTRIBUTES,cfg.ADD_URI_SAFE_ATTR,transformCaseFunc)}if(cfg.FORBID_CONTENTS){if(FORBID_CONTENTS===DEFAULT_FORBID_CONTENTS){FORBID_CONTENTS=clone(FORBID_CONTENTS)}addToSet(FORBID_CONTENTS,cfg.FORBID_CONTENTS,transformCaseFunc)}if(KEEP_CONTENT){ALLOWED_TAGS["#text"]=true}if(WHOLE_DOCUMENT){addToSet(ALLOWED_TAGS,["html","head","body"])}if(ALLOWED_TAGS.table){addToSet(ALLOWED_TAGS,["tbody"]);delete FORBID_TAGS.tbody}if(cfg.TRUSTED_TYPES_POLICY){if(typeof cfg.TRUSTED_TYPES_POLICY.createHTML!=="function"){throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.')}if(typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL!=="function"){throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.')}trustedTypesPolicy=cfg.TRUSTED_TYPES_POLICY;emptyHTML=trustedTypesPolicy.createHTML("")}else{if(trustedTypesPolicy===undefined){trustedTypesPolicy=_createTrustedTypesPolicy(trustedTypes,currentScript)}if(trustedTypesPolicy!==null&&typeof emptyHTML==="string"){emptyHTML=trustedTypesPolicy.createHTML("")}}if(freeze){freeze(cfg)}CONFIG=cfg};var ALL_SVG_TAGS=addToSet({},[].concat(_toConsumableArray(svg$1),_toConsumableArray(svgFilters),_toConsumableArray(svgDisallowed)));var ALL_MATHML_TAGS=addToSet({},[].concat(_toConsumableArray(mathMl$1),_toConsumableArray(mathMlDisallowed)));var _checkValidNamespace=function _checkValidNamespace(element){var parent=getParentNode(element);if(!parent||!parent.tagName){parent={namespaceURI:NAMESPACE,tagName:"template"}}var tagName=stringToLowerCase(element.tagName);var parentTagName=stringToLowerCase(parent.tagName);if(!ALLOWED_NAMESPACES[element.namespaceURI]){return false}if(element.namespaceURI===SVG_NAMESPACE){if(parent.namespaceURI===HTML_NAMESPACE){return tagName==="svg"}if(parent.namespaceURI===MATHML_NAMESPACE){return tagName==="svg"&&(parentTagName==="annotation-xml"||MATHML_TEXT_INTEGRATION_POINTS[parentTagName])}return Boolean(ALL_SVG_TAGS[tagName])}if(element.namespaceURI===MATHML_NAMESPACE){if(parent.namespaceURI===HTML_NAMESPACE){return tagName==="math"}if(parent.namespaceURI===SVG_NAMESPACE){return tagName==="math"&&HTML_INTEGRATION_POINTS[parentTagName]}return Boolean(ALL_MATHML_TAGS[tagName])}if(element.namespaceURI===HTML_NAMESPACE){if(parent.namespaceURI===SVG_NAMESPACE&&!HTML_INTEGRATION_POINTS[parentTagName]){return false}if(parent.namespaceURI===MATHML_NAMESPACE&&!MATHML_TEXT_INTEGRATION_POINTS[parentTagName]){return false}return!ALL_MATHML_TAGS[tagName]&&(COMMON_SVG_AND_HTML_ELEMENTS[tagName]||!ALL_SVG_TAGS[tagName])}if(PARSER_MEDIA_TYPE==="application/xhtml+xml"&&ALLOWED_NAMESPACES[element.namespaceURI]){return true}return false};var _forceRemove=function _forceRemove(node){arrayPush(DOMPurify.removed,{element:node});try{getParentNode(node).removeChild(node)}catch(_){remove(node)}};var _removeAttribute=function _removeAttribute(name,element){try{arrayPush(DOMPurify.removed,{attribute:element.getAttributeNode(name),from:element})}catch(_){arrayPush(DOMPurify.removed,{attribute:null,from:element})}element.removeAttribute(name);if(name==="is"){if(RETURN_DOM||RETURN_DOM_FRAGMENT){try{_forceRemove(element)}catch(_){}}else{try{element.setAttribute(name,"")}catch(_){}}}};var _initDocument=function _initDocument(dirty){var doc=null;var leadingWhitespace=null;if(FORCE_BODY){dirty="<remove></remove>"+dirty}else{var matches=stringMatch(dirty,/^[\r\n\t ]+/);leadingWhitespace=matches&&matches[0]}if(PARSER_MEDIA_TYPE==="application/xhtml+xml"&&NAMESPACE===HTML_NAMESPACE){dirty='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+dirty+"</body></html>"}var dirtyPayload=trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;if(NAMESPACE===HTML_NAMESPACE){try{doc=(new DOMParser).parseFromString(dirtyPayload,PARSER_MEDIA_TYPE)}catch(_){}}if(!doc||!doc.documentElement){doc=implementation.createDocument(NAMESPACE,"template",null);try{doc.documentElement.innerHTML=IS_EMPTY_INPUT?emptyHTML:dirtyPayload}catch(_){}}var body=doc.body||doc.documentElement;if(dirty&&leadingWhitespace){body.insertBefore(document.createTextNode(leadingWhitespace),body.childNodes[0]||null)}if(NAMESPACE===HTML_NAMESPACE){return getElementsByTagName.call(doc,WHOLE_DOCUMENT?"html":"body")[0]}return WHOLE_DOCUMENT?doc.documentElement:body};var _createNodeIterator=function _createNodeIterator(root){return createNodeIterator.call(root.ownerDocument||root,root,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT|NodeFilter.SHOW_PROCESSING_INSTRUCTION|NodeFilter.SHOW_CDATA_SECTION,null)};var _isClobbered=function _isClobbered(element){return element instanceof HTMLFormElement&&(typeof element.nodeName!=="string"||typeof element.textContent!=="string"||typeof element.removeChild!=="function"||!(element.attributes instanceof NamedNodeMap)||typeof element.removeAttribute!=="function"||typeof element.setAttribute!=="function"||typeof element.namespaceURI!=="string"||typeof element.insertBefore!=="function"||typeof element.hasChildNodes!=="function")};var _isNode=function _isNode(value){return typeof Node==="function"&&value instanceof Node};function _executeHooks(hooks,currentNode,data){arrayForEach(hooks,function(hook){hook.call(DOMPurify,currentNode,data,CONFIG)})}var _sanitizeElements=function _sanitizeElements(currentNode){var content=null;_executeHooks(hooks.beforeSanitizeElements,currentNode,null);if(_isClobbered(currentNode)){_forceRemove(currentNode);return true}var tagName=transformCaseFunc(currentNode.nodeName);_executeHooks(hooks.uponSanitizeElement,currentNode,{tagName:tagName,allowedTags:ALLOWED_TAGS});if(currentNode.hasChildNodes()&&!_isNode(currentNode.firstElementChild)&&regExpTest(/<[/\w]/g,currentNode.innerHTML)&&regExpTest(/<[/\w]/g,currentNode.textContent)){_forceRemove(currentNode);return true}if(currentNode.nodeType===NODE_TYPE.progressingInstruction){_forceRemove(currentNode);return true}if(SAFE_FOR_XML&&currentNode.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,currentNode.data)){_forceRemove(currentNode);return true}if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){if(!FORBID_TAGS[tagName]&&_isBasicCustomElement(tagName)){if(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,tagName)){return false}if(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)){return false}}if(KEEP_CONTENT&&!FORBID_CONTENTS[tagName]){var parentNode=getParentNode(currentNode)||currentNode.parentNode;var childNodes=getChildNodes(currentNode)||currentNode.childNodes;if(childNodes&&parentNode){var childCount=childNodes.length;for(var i=childCount-1;i>=0;--i){var childClone=cloneNode(childNodes[i],true);childClone.__removalCount=(currentNode.__removalCount||0)+1;parentNode.insertBefore(childClone,getNextSibling(currentNode))}}}_forceRemove(currentNode);return true}if(currentNode instanceof Element&&!_checkValidNamespace(currentNode)){_forceRemove(currentNode);return true}if((tagName==="noscript"||tagName==="noembed"||tagName==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,currentNode.innerHTML)){_forceRemove(currentNode);return true}if(SAFE_FOR_TEMPLATES&&currentNode.nodeType===NODE_TYPE.text){content=currentNode.textContent;arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],function(expr){content=stringReplace(content,expr," ")});if(currentNode.textContent!==content){arrayPush(DOMPurify.removed,{element:currentNode.cloneNode()});currentNode.textContent=content}}_executeHooks(hooks.afterSanitizeElements,currentNode,null);return false};var _isValidAttribute=function _isValidAttribute(lcTag,lcName,value){if(SANITIZE_DOM&&(lcName==="id"||lcName==="name")&&(value in document||value in formElement)){return false}if(ALLOW_DATA_ATTR&&!FORBID_ATTR[lcName]&&regExpTest(DATA_ATTR,lcName));else if(ALLOW_ARIA_ATTR&&regExpTest(ARIA_ATTR,lcName));else if(!ALLOWED_ATTR[lcName]||FORBID_ATTR[lcName]){if(_isBasicCustomElement(lcTag)&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,lcTag)||CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag))&&(CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck,lcName)||CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName))||lcName==="is"&&CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,value)||CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(value)));else{return false}}else if(URI_SAFE_ATTRIBUTES[lcName]);else if(regExpTest(IS_ALLOWED_URI$1,stringReplace(value,ATTR_WHITESPACE,"")));else if((lcName==="src"||lcName==="xlink:href"||lcName==="href")&&lcTag!=="script"&&stringIndexOf(value,"data:")===0&&DATA_URI_TAGS[lcTag]);else if(ALLOW_UNKNOWN_PROTOCOLS&&!regExpTest(IS_SCRIPT_OR_DATA,stringReplace(value,ATTR_WHITESPACE,"")));else if(value){return false}else;return true};var _isBasicCustomElement=function _isBasicCustomElement(tagName){return tagName!=="annotation-xml"&&stringMatch(tagName,CUSTOM_ELEMENT)};var _sanitizeAttributes=function _sanitizeAttributes(currentNode){_executeHooks(hooks.beforeSanitizeAttributes,currentNode,null);var attributes=currentNode.attributes;if(!attributes||_isClobbered(currentNode)){return}var hookEvent={attrName:"",attrValue:"",keepAttr:true,allowedAttributes:ALLOWED_ATTR,forceKeepAttr:undefined};var l=attributes.length;var _loop=function _loop(){var attr=attributes[l];var name=attr.name,namespaceURI=attr.namespaceURI,attrValue=attr.value;var lcName=transformCaseFunc(name);var value=name==="value"?attrValue:stringTrim(attrValue);hookEvent.attrName=lcName;hookEvent.attrValue=value;hookEvent.keepAttr=true;hookEvent.forceKeepAttr=undefined;_executeHooks(hooks.uponSanitizeAttribute,currentNode,hookEvent);value=hookEvent.attrValue;if(SANITIZE_NAMED_PROPS&&(lcName==="id"||lcName==="name")){_removeAttribute(name,currentNode);value=SANITIZE_NAMED_PROPS_PREFIX+value}if(SAFE_FOR_XML&&regExpTest(/((--!?|])>)|<\/(style|title)/i,value)){_removeAttribute(name,currentNode);return 0}if(hookEvent.forceKeepAttr){return 0}_removeAttribute(name,currentNode);if(!hookEvent.keepAttr){return 0}if(!ALLOW_SELF_CLOSE_IN_ATTR&&regExpTest(/\/>/i,value)){_removeAttribute(name,currentNode);return 0}if(SAFE_FOR_TEMPLATES){arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],function(expr){value=stringReplace(value,expr," ")})}var lcTag=transformCaseFunc(currentNode.nodeName);if(!_isValidAttribute(lcTag,lcName,value)){return 0}if(trustedTypesPolicy&&_typeof(trustedTypes)==="object"&&typeof trustedTypes.getAttributeType==="function"){if(namespaceURI);else{switch(trustedTypes.getAttributeType(lcTag,lcName)){case"TrustedHTML":{value=trustedTypesPolicy.createHTML(value);break}case"TrustedScriptURL":{value=trustedTypesPolicy.createScriptURL(value);break}}}}try{if(namespaceURI){currentNode.setAttributeNS(namespaceURI,name,value)}else{currentNode.setAttribute(name,value)}if(_isClobbered(currentNode)){_forceRemove(currentNode)}else{arrayPop(DOMPurify.removed)}}catch(_){}},_ret;while(l--){_ret=_loop();if(_ret===0)continue}_executeHooks(hooks.afterSanitizeAttributes,currentNode,null)};var _sanitizeShadowDOM=function _sanitizeShadowDOM(fragment){var shadowNode=null;var shadowIterator=_createNodeIterator(fragment);_executeHooks(hooks.beforeSanitizeShadowDOM,fragment,null);while(shadowNode=shadowIterator.nextNode()){_executeHooks(hooks.uponSanitizeShadowNode,shadowNode,null);_sanitizeElements(shadowNode);_sanitizeAttributes(shadowNode);if(shadowNode.content instanceof DocumentFragment){_sanitizeShadowDOM(shadowNode.content)}}_executeHooks(hooks.afterSanitizeShadowDOM,fragment,null)};DOMPurify.sanitize=function(dirty){var cfg=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var body=null;var importedNode=null;var currentNode=null;var returnNode=null;IS_EMPTY_INPUT=!dirty;if(IS_EMPTY_INPUT){dirty="\x3c!--\x3e"}if(typeof dirty!=="string"&&!_isNode(dirty)){if(typeof dirty.toString==="function"){dirty=dirty.toString();if(typeof dirty!=="string"){throw typeErrorCreate("dirty is not a string, aborting")}}else{throw typeErrorCreate("toString is not a function")}}if(!DOMPurify.isSupported){return dirty}if(!SET_CONFIG){_parseConfig(cfg)}DOMPurify.removed=[];if(typeof dirty==="string"){IN_PLACE=false}if(IN_PLACE){if(dirty.nodeName){var tagName=transformCaseFunc(dirty.nodeName);if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}}else if(dirty instanceof Node){body=_initDocument("\x3c!----\x3e");importedNode=body.ownerDocument.importNode(dirty,true);if(importedNode.nodeType===NODE_TYPE.element&&importedNode.nodeName==="BODY"){body=importedNode}else if(importedNode.nodeName==="HTML"){body=importedNode}else{body.appendChild(importedNode)}}else{if(!RETURN_DOM&&!SAFE_FOR_TEMPLATES&&!WHOLE_DOCUMENT&&dirty.indexOf("<")===-1){return trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(dirty):dirty}body=_initDocument(dirty);if(!body){return RETURN_DOM?null:RETURN_TRUSTED_TYPE?emptyHTML:""}}if(body&&FORCE_BODY){_forceRemove(body.firstChild)}var nodeIterator=_createNodeIterator(IN_PLACE?dirty:body);while(currentNode=nodeIterator.nextNode()){_sanitizeElements(currentNode);_sanitizeAttributes(currentNode);if(currentNode.content instanceof DocumentFragment){_sanitizeShadowDOM(currentNode.content)}}if(IN_PLACE){return dirty}if(RETURN_DOM){if(RETURN_DOM_FRAGMENT){returnNode=createDocumentFragment.call(body.ownerDocument);while(body.firstChild){returnNode.appendChild(body.firstChild)}}else{returnNode=body}if(ALLOWED_ATTR.shadowroot||ALLOWED_ATTR.shadowrootmode){returnNode=importNode.call(originalDocument,returnNode,true)}return returnNode}var serializedHTML=WHOLE_DOCUMENT?body.outerHTML:body.innerHTML;if(WHOLE_DOCUMENT&&ALLOWED_TAGS["!doctype"]&&body.ownerDocument&&body.ownerDocument.doctype&&body.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,body.ownerDocument.doctype.name)){serializedHTML="<!DOCTYPE "+body.ownerDocument.doctype.name+">\n"+serializedHTML}if(SAFE_FOR_TEMPLATES){arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],function(expr){serializedHTML=stringReplace(serializedHTML,expr," ")})}return trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(serializedHTML):serializedHTML};DOMPurify.setConfig=function(){var cfg=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_parseConfig(cfg);SET_CONFIG=true};DOMPurify.clearConfig=function(){CONFIG=null;SET_CONFIG=false};DOMPurify.isValidAttribute=function(tag,attr,value){if(!CONFIG){_parseConfig({})}var lcTag=transformCaseFunc(tag);var lcName=transformCaseFunc(attr);return _isValidAttribute(lcTag,lcName,value)};DOMPurify.addHook=function(entryPoint,hookFunction){if(typeof hookFunction!=="function"){return}arrayPush(hooks[entryPoint],hookFunction)};DOMPurify.removeHook=function(entryPoint){return arrayPop(hooks[entryPoint])};DOMPurify.removeHooks=function(entryPoint){hooks[entryPoint]=[]};DOMPurify.removeAllHooks=function(){hooks=_createHooksMap()};return DOMPurify}var purify=createDOMPurify();return purify})},{}],9:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var callBind=require("call-bind-apply-helpers");var gOPD=require("gopd");var hasProtoAccessor;try{hasProtoAccessor=[].__proto__===Array.prototype}catch(e){if(!e||_typeof(e)!=="object"||!("code"in e)||e.code!=="ERR_PROTO_ACCESS"){throw e}}var desc=!!hasProtoAccessor&&gOPD&&gOPD(Object.prototype,"__proto__");var $Object=Object;var $getPrototypeOf=$Object.getPrototypeOf;module.exports=desc&&typeof desc.get==="function"?callBind([desc.get]):typeof $getPrototypeOf==="function"?function getDunder(value){return $getPrototypeOf(value==null?value:$Object(value))}:false},{"call-bind-apply-helpers":5,gopd:23}],10:[function(require,module,exports){"use strict";var $defineProperty=Object.defineProperty||false;if($defineProperty){try{$defineProperty({},"a",{value:1})}catch(e){$defineProperty=false}}module.exports=$defineProperty},{}],11:[function(require,module,exports){"use strict";module.exports=EvalError},{}],12:[function(require,module,exports){"use strict";module.exports=Error},{}],13:[function(require,module,exports){"use strict";module.exports=RangeError},{}],14:[function(require,module,exports){"use strict";module.exports=ReferenceError},{}],15:[function(require,module,exports){"use strict";module.exports=SyntaxError},{}],16:[function(require,module,exports){"use strict";module.exports=TypeError},{}],17:[function(require,module,exports){"use strict";module.exports=URIError},{}],18:[function(require,module,exports){"use strict";module.exports=Object},{}],19:[function(require,module,exports){"use strict";var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var toStr=Object.prototype.toString;var max=Math.max;var funcType="[object Function]";var concatty=function concatty(a,b){var arr=[];for(var i=0;i<a.length;i+=1){arr[i]=a[i]}for(var j=0;j<b.length;j+=1){arr[j+a.length]=b[j]}return arr};var slicy=function slicy(arrLike,offset){var arr=[];for(var i=offset||0,j=0;i<arrLike.length;i+=1,j+=1){arr[j]=arrLike[i]}return arr};var joiny=function joiny(arr,joiner){var str="";for(var i=0;i<arr.length;i+=1){str+=arr[i];if(i+1<arr.length){str+=joiner}}return str};module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.apply(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target)}var args=slicy(arguments,1);var bound;var binder=function binder(){if(this instanceof bound){var result=target.apply(this,concatty(args,arguments));if(Object(result)===result){return result}return this}return target.apply(that,concatty(args,arguments))};var boundLength=max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs[i]="$"+i}bound=Function("binder","return function ("+joiny(boundArgs,",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty;Empty.prototype=null}return bound}},{}],20:[function(require,module,exports){"use strict";var implementation=require("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":19}],21:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var undefined;var $Object=require("es-object-atoms");var $Error=require("es-errors");var $EvalError=require("es-errors/eval");var $RangeError=require("es-errors/range");var $ReferenceError=require("es-errors/ref");var $SyntaxError=require("es-errors/syntax");var $TypeError=require("es-errors/type");var $URIError=require("es-errors/uri");var abs=require("math-intrinsics/abs");var floor=require("math-intrinsics/floor");var max=require("math-intrinsics/max");var min=require("math-intrinsics/min");var pow=require("math-intrinsics/pow");var $Function=Function;var getEvalledConstructor=function getEvalledConstructor(expressionSyntax){try{return $Function('"use strict"; return ('+expressionSyntax+").constructor;")()}catch(e){}};var $gOPD=require("gopd");var $defineProperty=require("es-define-property");var throwTypeError=function throwTypeError(){throw new $TypeError};var ThrowTypeError=$gOPD?function(){try{arguments.callee;return throwTypeError}catch(calleeThrows){try{return $gOPD(arguments,"callee").get}catch(gOPDthrows){return throwTypeError}}}():throwTypeError;var hasSymbols=require("has-symbols")();var getDunderProto=require("dunder-proto/get");var getProto=typeof Reflect==="function"&&Reflect.getPrototypeOf||$Object.getPrototypeOf||getDunderProto;var $apply=require("call-bind-apply-helpers/functionApply");var $call=require("call-bind-apply-helpers/functionCall");var needsEval={};var TypedArray=typeof Uint8Array==="undefined"||!getProto?undefined:getProto(Uint8Array);var INTRINSICS={__proto__:null,"%AggregateError%":typeof AggregateError==="undefined"?undefined:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer==="undefined"?undefined:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols&&getProto?getProto([][Symbol.iterator]()):undefined,"%AsyncFromSyncIteratorPrototype%":undefined,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics==="undefined"?undefined:Atomics,"%BigInt%":typeof BigInt==="undefined"?undefined:BigInt,"%BigInt64Array%":typeof BigInt64Array==="undefined"?undefined:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array==="undefined"?undefined:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView==="undefined"?undefined:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":$Error,"%eval%":eval,"%EvalError%":$EvalError,"%Float32Array%":typeof Float32Array==="undefined"?undefined:Float32Array,"%Float64Array%":typeof Float64Array==="undefined"?undefined:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry==="undefined"?undefined:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array==="undefined"?undefined:Int8Array,"%Int16Array%":typeof Int16Array==="undefined"?undefined:Int16Array,"%Int32Array%":typeof Int32Array==="undefined"?undefined:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols&&getProto?getProto(getProto([][Symbol.iterator]())):undefined,"%JSON%":(typeof JSON==="undefined"?"undefined":_typeof(JSON))==="object"?JSON:undefined,"%Map%":typeof Map==="undefined"?undefined:Map,"%MapIteratorPrototype%":typeof Map==="undefined"||!hasSymbols||!getProto?undefined:getProto((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":$Object,"%Object.getOwnPropertyDescriptor%":$gOPD,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise==="undefined"?undefined:Promise,"%Proxy%":typeof Proxy==="undefined"?undefined:Proxy,"%RangeError%":$RangeError,"%ReferenceError%":$ReferenceError,"%Reflect%":typeof Reflect==="undefined"?undefined:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set==="undefined"?undefined:Set,"%SetIteratorPrototype%":typeof Set==="undefined"||!hasSymbols||!getProto?undefined:getProto((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer==="undefined"?undefined:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols&&getProto?getProto(""[Symbol.iterator]()):undefined,"%Symbol%":hasSymbols?Symbol:undefined,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":typeof Uint8Array==="undefined"?undefined:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray==="undefined"?undefined:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array==="undefined"?undefined:Uint16Array,"%Uint32Array%":typeof Uint32Array==="undefined"?undefined:Uint32Array,"%URIError%":$URIError,"%WeakMap%":typeof WeakMap==="undefined"?undefined:WeakMap,"%WeakRef%":typeof WeakRef==="undefined"?undefined:WeakRef,"%WeakSet%":typeof WeakSet==="undefined"?undefined:WeakSet,"%Function.prototype.call%":$call,"%Function.prototype.apply%":$apply,"%Object.defineProperty%":$defineProperty,"%Math.abs%":abs,"%Math.floor%":floor,"%Math.max%":max,"%Math.min%":min,"%Math.pow%":pow};if(getProto){try{null.error}catch(e){var errorProto=getProto(getProto(e));INTRINSICS["%Error.prototype%"]=errorProto}}var doEval=function doEval(name){var value;if(name==="%AsyncFunction%"){value=getEvalledConstructor("async function () {}")}else if(name==="%GeneratorFunction%"){value=getEvalledConstructor("function* () {}")}else if(name==="%AsyncGeneratorFunction%"){value=getEvalledConstructor("async function* () {}")}else if(name==="%AsyncGenerator%"){var fn=doEval("%AsyncGeneratorFunction%");if(fn){value=fn.prototype}}else if(name==="%AsyncIteratorPrototype%"){var gen=doEval("%AsyncGenerator%");if(gen&&getProto){value=getProto(gen.prototype)}}INTRINSICS[name]=value;return value};var LEGACY_ALIASES={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]};var bind=require("function-bind");var hasOwn=require("hasown");var $concat=bind.call($call,Array.prototype.concat);var $spliceApply=bind.call($apply,Array.prototype.splice);var $replace=bind.call($call,String.prototype.replace);var $strSlice=bind.call($call,String.prototype.slice);var $exec=bind.call($call,RegExp.prototype.exec);var rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=function stringToPath(string){var first=$strSlice(string,0,1);var last=$strSlice(string,-1);if(first==="%"&&last!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`")}else if(last==="%"&&first!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`")}var result=[];$replace(string,rePropName,function(match,number,quote,subString){result[result.length]=quote?$replace(subString,reEscapeChar,"$1"):number||match});return result};var getBaseIntrinsic=function getBaseIntrinsic(name,allowMissing){var intrinsicName=name;var alias;if(hasOwn(LEGACY_ALIASES,intrinsicName)){alias=LEGACY_ALIASES[intrinsicName];intrinsicName="%"+alias[0]+"%"}if(hasOwn(INTRINSICS,intrinsicName)){var value=INTRINSICS[intrinsicName];if(value===needsEval){value=doEval(intrinsicName)}if(typeof value==="undefined"&&!allowMissing){throw new $TypeError("intrinsic "+name+" exists, but is not available. Please file an issue!")}return{alias:alias,name:intrinsicName,value:value}}throw new $SyntaxError("intrinsic "+name+" does not exist!")};module.exports=function GetIntrinsic(name,allowMissing){if(typeof name!=="string"||name.length===0){throw new $TypeError("intrinsic name must be a non-empty string")}if(arguments.length>1&&typeof allowMissing!=="boolean"){throw new $TypeError('"allowMissing" argument must be a boolean')}if($exec(/^%?[^%]*%?$/,name)===null){throw new $SyntaxError("`%` may not be present anywhere but at the beginning and end of the intrinsic name")}var parts=stringToPath(name);var intrinsicBaseName=parts.length>0?parts[0]:"";var intrinsic=getBaseIntrinsic("%"+intrinsicBaseName+"%",allowMissing);var intrinsicRealName=intrinsic.name;var value=intrinsic.value;var skipFurtherCaching=false;var alias=intrinsic.alias;if(alias){intrinsicBaseName=alias[0];$spliceApply(parts,$concat([0,1],alias))}for(var i=1,isOwn=true;i<parts.length;i+=1){var part=parts[i];var first=$strSlice(part,0,1);var last=$strSlice(part,-1);if((first==='"'||first==="'"||first==="`"||last==='"'||last==="'"||last==="`")&&first!==last){throw new $SyntaxError("property names with quotes must have matching quotes")}if(part==="constructor"||!isOwn){skipFurtherCaching=true}intrinsicBaseName+="."+part;intrinsicRealName="%"+intrinsicBaseName+"%";if(hasOwn(INTRINSICS,intrinsicRealName)){value=INTRINSICS[intrinsicRealName]}else if(value!=null){if(!(part in value)){if(!allowMissing){throw new $TypeError("base intrinsic for "+name+" exists, but the property is not available.")}return void undefined}if($gOPD&&i+1>=parts.length){var desc=$gOPD(value,part);isOwn=!!desc;if(isOwn&&"get"in desc&&!("originalValue"in desc.get)){value=desc.get}else{value=value[part]}}else{isOwn=hasOwn(value,part);value=value[part]}if(isOwn&&!skipFurtherCaching){INTRINSICS[intrinsicRealName]=value}}}return value}},{"call-bind-apply-helpers/functionApply":3,"call-bind-apply-helpers/functionCall":4,"dunder-proto/get":9,"es-define-property":10,"es-errors":12,"es-errors/eval":11,"es-errors/range":13,"es-errors/ref":14,"es-errors/syntax":15,"es-errors/type":16,"es-errors/uri":17,"es-object-atoms":18,"function-bind":20,gopd:23,"has-symbols":24,hasown:26,"math-intrinsics/abs":33,"math-intrinsics/floor":34,"math-intrinsics/max":35,"math-intrinsics/min":36,"math-intrinsics/pow":37}],22:[function(require,module,exports){"use strict";module.exports=Object.getOwnPropertyDescriptor},{}],23:[function(require,module,exports){"use strict";var $gOPD=require("./gOPD");if($gOPD){try{$gOPD([],"length")}catch(e){$gOPD=null}}module.exports=$gOPD},{"./gOPD":22}],24:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var origSymbol=typeof Symbol!=="undefined"&&Symbol;var hasSymbolSham=require("./shams");module.exports=function hasNativeSymbols(){if(typeof origSymbol!=="function"){return false}if(typeof Symbol!=="function"){return false}if(_typeof(origSymbol("foo"))!=="symbol"){return false}if(_typeof(Symbol("bar"))!=="symbol"){return false}return hasSymbolSham()}},{"./shams":25}],25:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(_typeof(Symbol.iterator)==="symbol"){return true}var obj={};var sym=Symbol("test");var symObj=Object(sym);if(typeof sym==="string"){return false}if(Object.prototype.toString.call(sym)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(symObj)!=="[object Symbol]"){return false}var symVal=42;obj[sym]=symVal;for(var _ in obj){return false}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false}}return true}},{}],26:[function(require,module,exports){"use strict";var call=Function.prototype.call;var $hasOwn=Object.prototype.hasOwnProperty;var bind=require("function-bind");module.exports=bind.call(call,$hasOwn)},{"function-bind":20}],27:[function(require,module,exports){"use strict";function e(e){this.message=e}e.prototype=new Error,e.prototype.name="InvalidCharacterError";var r="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(r){var t=String(r).replace(/=+$/,"");if(t.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,a=0,i=0,c="";o=t.charAt(i++);~o&&(n=a%4?64*n+o:o,a++%4)?c+=String.fromCharCode(255&n>>(-2*a&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return c};function t(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,function(e,r){var t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}(t)}catch(e){return r(t)}}function n(e){this.message=e}function o(e,r){if("string"!=typeof e)throw new n("Invalid token specified");var o=!0===(r=r||{}).header?0:1;try{return JSON.parse(t(e.split(".")[o]))}catch(e){throw new n("Invalid token specified: "+e.message)}}n.prototype=new Error,n.prototype.name="InvalidTokenError";var a=o;a["default"]=o,a.InvalidTokenError=n,module.exports=a},{}],28:[function(require,module,exports){module.exports={"cardOnFile.authorization":"Card on File Authorization","cardOnFile.termsAndConditions":"Terms & Conditions","cardOnFile.accept":"ACCEPT","cardOnFile.decline":"DECLINE"}},{}],29:[function(require,module,exports){arguments[4][28][0].apply(exports,arguments)},{dup:28}],30:[function(require,module,exports){module.exports={"cardOnFile.authorization":"Autorisation de la carte au dossier","cardOnFile.termsAndConditions":"Conditions dutilisation","cardOnFile.accept":"ACCEPTER","cardOnFile.decline":"REFUSER"}},{}],31:[function(require,module,exports){module.exports={"cardOnFile.authorization":"Autorisation de la carte enregistre","cardOnFile.termsAndConditions":"Conditions gnrales","cardOnFile.accept":"ACCEPTER","cardOnFile.decline":"REFUSER"}},{}],32:[function(require,module,exports){module.exports={"cardOnFile.authorization":"Autorizzazione carta su file","cardOnFile.termsAndConditions":"Termini e condizioni","cardOnFile.accept":"ACCETTA","cardOnFile.decline":"RIFIUTA"}},{}],33:[function(require,module,exports){"use strict";module.exports=Math.abs},{}],34:[function(require,module,exports){"use strict";module.exports=Math.floor},{}],35:[function(require,module,exports){"use strict";module.exports=Math.max},{}],36:[function(require,module,exports){"use strict";module.exports=Math.min},{}],37:[function(require,module,exports){"use strict";module.exports=Math.pow},{}],38:[function(require,module,exports){(function(global){(function(){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var hasMap=typeof Map==="function"&&Map.prototype;var mapSizeDescriptor=Object.getOwnPropertyDescriptor&&hasMap?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null;var mapSize=hasMap&&mapSizeDescriptor&&typeof mapSizeDescriptor.get==="function"?mapSizeDescriptor.get:null;var mapForEach=hasMap&&Map.prototype.forEach;var hasSet=typeof Set==="function"&&Set.prototype;var setSizeDescriptor=Object.getOwnPropertyDescriptor&&hasSet?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null;var setSize=hasSet&&setSizeDescriptor&&typeof setSizeDescriptor.get==="function"?setSizeDescriptor.get:null;var setForEach=hasSet&&Set.prototype.forEach;var hasWeakMap=typeof WeakMap==="function"&&WeakMap.prototype;var weakMapHas=hasWeakMap?WeakMap.prototype.has:null;var hasWeakSet=typeof WeakSet==="function"&&WeakSet.prototype;var weakSetHas=hasWeakSet?WeakSet.prototype.has:null;var hasWeakRef=typeof WeakRef==="function"&&WeakRef.prototype;var weakRefDeref=hasWeakRef?WeakRef.prototype.deref:null;var booleanValueOf=Boolean.prototype.valueOf;var objectToString=Object.prototype.toString;var functionToString=Function.prototype.toString;var $match=String.prototype.match;var $slice=String.prototype.slice;var $replace=String.prototype.replace;var $toUpperCase=String.prototype.toUpperCase;var $toLowerCase=String.prototype.toLowerCase;var $test=RegExp.prototype.test;var $concat=Array.prototype.concat;var $join=Array.prototype.join;var $arrSlice=Array.prototype.slice;var $floor=Math.floor;var bigIntValueOf=typeof BigInt==="function"?BigInt.prototype.valueOf:null;var gOPS=Object.getOwnPropertySymbols;var symToString=typeof Symbol==="function"&&_typeof(Symbol.iterator)==="symbol"?Symbol.prototype.toString:null;var hasShammedSymbols=typeof Symbol==="function"&&_typeof(Symbol.iterator)==="object";var toStringTag=typeof Symbol==="function"&&Symbol.toStringTag&&(_typeof(Symbol.toStringTag)===hasShammedSymbols?"object":"symbol")?Symbol.toStringTag:null;var isEnumerable=Object.prototype.propertyIsEnumerable;var gPO=(typeof Reflect==="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(O){return O.__proto__}:null);function addNumericSeparator(num,str){if(num===Infinity||num===-Infinity||num!==num||num&&num>-1e3&&num<1e3||$test.call(/e/,str)){return str}var sepRegex=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof num==="number"){var _int=num<0?-$floor(-num):$floor(num);if(_int!==num){var intStr=String(_int);var dec=$slice.call(str,intStr.length+1);return $replace.call(intStr,sepRegex,"$&_")+"."+$replace.call($replace.call(dec,/([0-9]{3})/g,"$&_"),/_$/,"")}}return $replace.call(str,sepRegex,"$&_")}var utilInspect=require("./util.inspect");var inspectCustom=utilInspect.custom;var inspectSymbol=isSymbol(inspectCustom)?inspectCustom:null;var quotes={__proto__:null,double:'"',single:"'"};var quoteREs={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};module.exports=function inspect_(obj,options,depth,seen){var opts=options||{};if(has(opts,"quoteStyle")&&!has(quotes,opts.quoteStyle)){throw new TypeError('option "quoteStyle" must be "single" or "double"')}if(has(opts,"maxStringLength")&&(typeof opts.maxStringLength==="number"?opts.maxStringLength<0&&opts.maxStringLength!==Infinity:opts.maxStringLength!==null)){throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`')}var customInspect=has(opts,"customInspect")?opts.customInspect:true;if(typeof customInspect!=="boolean"&&customInspect!=="symbol"){throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`")}if(has(opts,"indent")&&opts.indent!==null&&opts.indent!=="\t"&&!(parseInt(opts.indent,10)===opts.indent&&opts.indent>0)){throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`')}if(has(opts,"numericSeparator")&&typeof opts.numericSeparator!=="boolean"){throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`')}var numericSeparator=opts.numericSeparator;if(typeof obj==="undefined"){return"undefined"}if(obj===null){return"null"}if(typeof obj==="boolean"){return obj?"true":"false"}if(typeof obj==="string"){return inspectString(obj,opts)}if(typeof obj==="number"){if(obj===0){return Infinity/obj>0?"0":"-0"}var str=String(obj);return numericSeparator?addNumericSeparator(obj,str):str}if(typeof obj==="bigint"){var bigIntStr=String(obj)+"n";return numericSeparator?addNumericSeparator(obj,bigIntStr):bigIntStr}var maxDepth=typeof opts.depth==="undefined"?5:opts.depth;if(typeof depth==="undefined"){depth=0}if(depth>=maxDepth&&maxDepth>0&&_typeof(obj)==="object"){return isArray(obj)?"[Array]":"[Object]"}var indent=getIndent(opts,depth);if(typeof seen==="undefined"){seen=[]}else if(indexOf(seen,obj)>=0){return"[Circular]"}function inspect(value,from,noIndent){if(from){seen=$arrSlice.call(seen);seen.push(from)}if(noIndent){var newOpts={depth:opts.depth};if(has(opts,"quoteStyle")){newOpts.quoteStyle=opts.quoteStyle}return inspect_(value,newOpts,depth+1,seen)}return inspect_(value,opts,depth+1,seen)}if(typeof obj==="function"&&!isRegExp(obj)){var name=nameOf(obj);var keys=arrObjKeys(obj,inspect);return"[Function"+(name?": "+name:" (anonymous)")+"]"+(keys.length>0?" { "+$join.call(keys,", ")+" }":"")}if(isSymbol(obj)){var symString=hasShammedSymbols?$replace.call(String(obj),/^(Symbol\(.*\))_[^)]*$/,"$1"):symToString.call(obj);return _typeof(obj)==="object"&&!hasShammedSymbols?markBoxed(symString):symString}if(isElement(obj)){var s="<"+$toLowerCase.call(String(obj.nodeName));var attrs=obj.attributes||[];for(var i=0;i<attrs.length;i++){s+=" "+attrs[i].name+"="+wrapQuotes(quote(attrs[i].value),"double",opts)}s+=">";if(obj.childNodes&&obj.childNodes.length){s+="..."}s+="</"+$toLowerCase.call(String(obj.nodeName))+">";return s}if(isArray(obj)){if(obj.length===0){return"[]"}var xs=arrObjKeys(obj,inspect);if(indent&&!singleLineValues(xs)){return"["+indentedJoin(xs,indent)+"]"}return"[ "+$join.call(xs,", ")+" ]"}if(isError(obj)){var parts=arrObjKeys(obj,inspect);if(!("cause"in Error.prototype)&&"cause"in obj&&!isEnumerable.call(obj,"cause")){return"{ ["+String(obj)+"] "+$join.call($concat.call("[cause]: "+inspect(obj.cause),parts),", ")+" }"}if(parts.length===0){return"["+String(obj)+"]"}return"{ ["+String(obj)+"] "+$join.call(parts,", ")+" }"}if(_typeof(obj)==="object"&&customInspect){if(inspectSymbol&&typeof obj[inspectSymbol]==="function"&&utilInspect){return utilInspect(obj,{depth:maxDepth-depth})}else if(customInspect!=="symbol"&&typeof obj.inspect==="function"){return obj.inspect()}}if(isMap(obj)){var mapParts=[];if(mapForEach){mapForEach.call(obj,function(value,key){mapParts.push(inspect(key,obj,true)+" => "+inspect(value,obj))})}return collectionOf("Map",mapSize.call(obj),mapParts,indent)}if(isSet(obj)){var setParts=[];if(setForEach){setForEach.call(obj,function(value){setParts.push(inspect(value,obj))})}return collectionOf("Set",setSize.call(obj),setParts,indent)}if(isWeakMap(obj)){return weakCollectionOf("WeakMap")}if(isWeakSet(obj)){return weakCollectionOf("WeakSet")}if(isWeakRef(obj)){return weakCollectionOf("WeakRef")}if(isNumber(obj)){return markBoxed(inspect(Number(obj)))}if(isBigInt(obj)){return markBoxed(inspect(bigIntValueOf.call(obj)))}if(isBoolean(obj)){return markBoxed(booleanValueOf.call(obj))}if(isString(obj)){return markBoxed(inspect(String(obj)))}if(typeof window!=="undefined"&&obj===window){return"{ [object Window] }"}if(typeof globalThis!=="undefined"&&obj===globalThis||typeof global!=="undefined"&&obj===global){return"{ [object globalThis] }"}if(!isDate(obj)&&!isRegExp(obj)){var ys=arrObjKeys(obj,inspect);var isPlainObject=gPO?gPO(obj)===Object.prototype:obj instanceof Object||obj.constructor===Object;var protoTag=obj instanceof Object?"":"null prototype";var stringTag=!isPlainObject&&toStringTag&&Object(obj)===obj&&toStringTag in obj?$slice.call(toStr(obj),8,-1):protoTag?"Object":"";var constructorTag=isPlainObject||typeof obj.constructor!=="function"?"":obj.constructor.name?obj.constructor.name+" ":"";var tag=constructorTag+(stringTag||protoTag?"["+$join.call($concat.call([],stringTag||[],protoTag||[]),": ")+"] ":"");if(ys.length===0){return tag+"{}"}if(indent){return tag+"{"+indentedJoin(ys,indent)+"}"}return tag+"{ "+$join.call(ys,", ")+" }"}return String(obj)};function wrapQuotes(s,defaultStyle,opts){var style=opts.quoteStyle||defaultStyle;var quoteChar=quotes[style];return quoteChar+s+quoteChar}function quote(s){return $replace.call(String(s),/"/g,"&quot;")}function isArray(obj){return toStr(obj)==="[object Array]"&&(!toStringTag||!(_typeof(obj)==="object"&&toStringTag in obj))}function isDate(obj){return toStr(obj)==="[object Date]"&&(!toStringTag||!(_typeof(obj)==="object"&&toStringTag in obj))}function isRegExp(obj){return toStr(obj)==="[object RegExp]"&&(!toStringTag||!(_typeof(obj)==="object"&&toStringTag in obj))}function isError(obj){return toStr(obj)==="[object Error]"&&(!toStringTag||!(_typeof(obj)==="object"&&toStringTag in obj))}function isString(obj){return toStr(obj)==="[object String]"&&(!toStringTag||!(_typeof(obj)==="object"&&toStringTag in obj))}function isNumber(obj){return toStr(obj)==="[object Number]"&&(!toStringTag||!(_typeof(obj)==="object"&&toStringTag in obj))}function isBoolean(obj){return toStr(obj)==="[object Boolean]"&&(!toStringTag||!(_typeof(obj)==="object"&&toStringTag in obj))}function isSymbol(obj){if(hasShammedSymbols){return obj&&_typeof(obj)==="object"&&obj instanceof Symbol}if(_typeof(obj)==="symbol"){return true}if(!obj||_typeof(obj)!=="object"||!symToString){return false}try{symToString.call(obj);return true}catch(e){}return false}function isBigInt(obj){if(!obj||_typeof(obj)!=="object"||!bigIntValueOf){return false}try{bigIntValueOf.call(obj);return true}catch(e){}return false}var hasOwn=Object.prototype.hasOwnProperty||function(key){return key in this};function has(obj,key){return hasOwn.call(obj,key)}function toStr(obj){return objectToString.call(obj)}function nameOf(f){if(f.name){return f.name}var m=$match.call(functionToString.call(f),/^function\s*([\w$]+)/);if(m){return m[1]}return null}function indexOf(xs,x){if(xs.indexOf){return xs.indexOf(x)}for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x){return i}}return-1}function isMap(x){if(!mapSize||!x||_typeof(x)!=="object"){return false}try{mapSize.call(x);try{setSize.call(x)}catch(s){return true}return x instanceof Map}catch(e){}return false}function isWeakMap(x){if(!weakMapHas||!x||_typeof(x)!=="object"){return false}try{weakMapHas.call(x,weakMapHas);try{weakSetHas.call(x,weakSetHas)}catch(s){return true}return x instanceof WeakMap}catch(e){}return false}function isWeakRef(x){if(!weakRefDeref||!x||_typeof(x)!=="object"){return false}try{weakRefDeref.call(x);return true}catch(e){}return false}function isSet(x){if(!setSize||!x||_typeof(x)!=="object"){return false}try{setSize.call(x);try{mapSize.call(x)}catch(m){return true}return x instanceof Set}catch(e){}return false}function isWeakSet(x){if(!weakSetHas||!x||_typeof(x)!=="object"){return false}try{weakSetHas.call(x,weakSetHas);try{weakMapHas.call(x,weakMapHas)}catch(s){return true}return x instanceof WeakSet}catch(e){}return false}function isElement(x){if(!x||_typeof(x)!=="object"){return false}if(typeof HTMLElement!=="undefined"&&x instanceof HTMLElement){return true}return typeof x.nodeName==="string"&&typeof x.getAttribute==="function"}function inspectString(str,opts){if(str.length>opts.maxStringLength){var remaining=str.length-opts.maxStringLength;var trailer="... "+remaining+" more character"+(remaining>1?"s":"");return inspectString($slice.call(str,0,opts.maxStringLength),opts)+trailer}var quoteRE=quoteREs[opts.quoteStyle||"single"];quoteRE.lastIndex=0;var s=$replace.call($replace.call(str,quoteRE,"\\$1"),/[\x00-\x1f]/g,lowbyte);return wrapQuotes(s,"single",opts)}function lowbyte(c){var n=c.charCodeAt(0);var x={8:"b",9:"t",10:"n",12:"f",13:"r"}[n];if(x){return"\\"+x}return"\\x"+(n<16?"0":"")+$toUpperCase.call(n.toString(16))}function markBoxed(str){return"Object("+str+")"}function weakCollectionOf(type){return type+" { ? }"}function collectionOf(type,size,entries,indent){var joinedEntries=indent?indentedJoin(entries,indent):$join.call(entries,", ");return type+" ("+size+") {"+joinedEntries+"}"}function singleLineValues(xs){for(var i=0;i<xs.length;i++){if(indexOf(xs[i],"\n")>=0){return false}}return true}function getIndent(opts,depth){var baseIndent;if(opts.indent==="\t"){baseIndent="\t"}else if(typeof opts.indent==="number"&&opts.indent>0){baseIndent=$join.call(Array(opts.indent+1)," ")}else{return null}return{base:baseIndent,prev:$join.call(Array(depth+1),baseIndent)}}function indentedJoin(xs,indent){if(xs.length===0){return""}var lineJoiner="\n"+indent.prev+indent.base;return lineJoiner+$join.call(xs,","+lineJoiner)+"\n"+indent.prev}function arrObjKeys(obj,inspect){var isArr=isArray(obj);var xs=[];if(isArr){xs.length=obj.length;for(var i=0;i<obj.length;i++){xs[i]=has(obj,i)?inspect(obj[i],obj):""}}var syms=typeof gOPS==="function"?gOPS(obj):[];var symMap;if(hasShammedSymbols){symMap={};for(var k=0;k<syms.length;k++){symMap["$"+syms[k]]=syms[k]}}for(var key in obj){if(!has(obj,key)){continue}if(isArr&&String(Number(key))===key&&key<obj.length){continue}if(hasShammedSymbols&&symMap["$"+key]instanceof Symbol){continue}else if($test.call(/[^\w$]/,key)){xs.push(inspect(key,obj)+": "+inspect(obj[key],obj))}else{xs.push(key+": "+inspect(obj[key],obj))}}if(typeof gOPS==="function"){for(var j=0;j<syms.length;j++){if(isEnumerable.call(obj,syms[j])){xs.push("["+inspect(syms[j])+"]: "+inspect(obj[syms[j]],obj))}}}return xs}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./util.inspect":1}],39:[function(require,module,exports){"use strict";var replace=String.prototype.replace;var percentTwenties=/%20/g;var Format={RFC1738:"RFC1738",RFC3986:"RFC3986"};module.exports={default:Format.RFC3986,formatters:{RFC1738:function RFC1738(value){return replace.call(value,percentTwenties,"+")},RFC3986:function RFC3986(value){return String(value)}},RFC1738:Format.RFC1738,RFC3986:Format.RFC3986}},{}],40:[function(require,module,exports){"use strict";var stringify=require("./stringify");var parse=require("./parse");var formats=require("./formats");module.exports={formats:formats,parse:parse,stringify:stringify}},{"./formats":39,"./parse":41,"./stringify":42}],41:[function(require,module,exports){"use strict";var utils=require("./utils");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var defaults={allowDots:false,allowEmptyArrays:false,allowPrototypes:false,allowSparse:false,arrayLimit:20,charset:"utf-8",charsetSentinel:false,comma:false,decodeDotInKeys:false,decoder:utils.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:false,interpretNumericEntities:false,parameterLimit:1e3,parseArrays:true,plainObjects:false,strictDepth:false,strictNullHandling:false};var interpretNumericEntities=function interpretNumericEntities(str){return str.replace(/&#(\d+);/g,function($0,numberStr){return String.fromCharCode(parseInt(numberStr,10))})};var parseArrayValue=function parseArrayValue(val,options){if(val&&typeof val==="string"&&options.comma&&val.indexOf(",")>-1){return val.split(",")}return val};var isoSentinel="utf8=%26%2310003%3B";var charsetSentinel="utf8=%E2%9C%93";var parseValues=function parseQueryStringValues(str,options){var obj={__proto__:null};var cleanStr=options.ignoreQueryPrefix?str.replace(/^\?/,""):str;cleanStr=cleanStr.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var limit=options.parameterLimit===Infinity?undefined:options.parameterLimit;var parts=cleanStr.split(options.delimiter,limit);var skipIndex=-1;var i;var charset=options.charset;if(options.charsetSentinel){for(i=0;i<parts.length;++i){if(parts[i].indexOf("utf8=")===0){if(parts[i]===charsetSentinel){charset="utf-8"}else if(parts[i]===isoSentinel){charset="iso-8859-1"}skipIndex=i;i=parts.length}}}for(i=0;i<parts.length;++i){if(i===skipIndex){continue}var part=parts[i];var bracketEqualsPos=part.indexOf("]=");var pos=bracketEqualsPos===-1?part.indexOf("="):bracketEqualsPos+1;var key;var val;if(pos===-1){key=options.decoder(part,defaults.decoder,charset,"key");val=options.strictNullHandling?null:""}else{key=options.decoder(part.slice(0,pos),defaults.decoder,charset,"key");val=utils.maybeMap(parseArrayValue(part.slice(pos+1),options),function(encodedVal){return options.decoder(encodedVal,defaults.decoder,charset,"value")})}if(val&&options.interpretNumericEntities&&charset==="iso-8859-1"){val=interpretNumericEntities(String(val))}if(part.indexOf("[]=")>-1){val=isArray(val)?[val]:val}var existing=has.call(obj,key);if(existing&&options.duplicates==="combine"){obj[key]=utils.combine(obj[key],val)}else if(!existing||options.duplicates==="last"){obj[key]=val}}return obj};var parseObject=function parseObject(chain,val,options,valuesParsed){var leaf=valuesParsed?val:parseArrayValue(val,options);for(var i=chain.length-1;i>=0;--i){var obj;var root=chain[i];if(root==="[]"&&options.parseArrays){obj=options.allowEmptyArrays&&(leaf===""||options.strictNullHandling&&leaf===null)?[]:[].concat(leaf)}else{obj=options.plainObjects?{__proto__:null}:{};var cleanRoot=root.charAt(0)==="["&&root.charAt(root.length-1)==="]"?root.slice(1,-1):root;var decodedRoot=options.decodeDotInKeys?cleanRoot.replace(/%2E/g,"."):cleanRoot;var index=parseInt(decodedRoot,10);if(!options.parseArrays&&decodedRoot===""){obj={0:leaf}}else if(!isNaN(index)&&root!==decodedRoot&&String(index)===decodedRoot&&index>=0&&options.parseArrays&&index<=options.arrayLimit){obj=[];obj[index]=leaf}else if(decodedRoot!=="__proto__"){obj[decodedRoot]=leaf}}leaf=obj}return leaf};var parseKeys=function parseQueryStringKeys(givenKey,val,options,valuesParsed){if(!givenKey){return}var key=options.allowDots?givenKey.replace(/\.([^.[]+)/g,"[$1]"):givenKey;var brackets=/(\[[^[\]]*])/;var child=/(\[[^[\]]*])/g;var segment=options.depth>0&&brackets.exec(key);var parent=segment?key.slice(0,segment.index):key;var keys=[];if(parent){if(!options.plainObjects&&has.call(Object.prototype,parent)){if(!options.allowPrototypes){return}}keys.push(parent)}var i=0;while(options.depth>0&&(segment=child.exec(key))!==null&&i<options.depth){i+=1;if(!options.plainObjects&&has.call(Object.prototype,segment[1].slice(1,-1))){if(!options.allowPrototypes){return}}keys.push(segment[1])}if(segment){if(options.strictDepth===true){throw new RangeError("Input depth exceeded depth option of "+options.depth+" and strictDepth is true")}keys.push("["+key.slice(segment.index)+"]")}return parseObject(keys,val,options,valuesParsed)};var normalizeParseOptions=function normalizeParseOptions(opts){if(!opts){return defaults}if(typeof opts.allowEmptyArrays!=="undefined"&&typeof opts.allowEmptyArrays!=="boolean"){throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided")}if(typeof opts.decodeDotInKeys!=="undefined"&&typeof opts.decodeDotInKeys!=="boolean"){throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided")}if(opts.decoder!==null&&typeof opts.decoder!=="undefined"&&typeof opts.decoder!=="function"){throw new TypeError("Decoder has to be a function.")}if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var charset=typeof opts.charset==="undefined"?defaults.charset:opts.charset;var duplicates=typeof opts.duplicates==="undefined"?defaults.duplicates:opts.duplicates;if(duplicates!=="combine"&&duplicates!=="first"&&duplicates!=="last"){throw new TypeError("The duplicates option must be either combine, first, or last")}var allowDots=typeof opts.allowDots==="undefined"?opts.decodeDotInKeys===true?true:defaults.allowDots:!!opts.allowDots;return{allowDots:allowDots,allowEmptyArrays:typeof opts.allowEmptyArrays==="boolean"?!!opts.allowEmptyArrays:defaults.allowEmptyArrays,allowPrototypes:typeof opts.allowPrototypes==="boolean"?opts.allowPrototypes:defaults.allowPrototypes,allowSparse:typeof opts.allowSparse==="boolean"?opts.allowSparse:defaults.allowSparse,arrayLimit:typeof opts.arrayLimit==="number"?opts.arrayLimit:defaults.arrayLimit,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,comma:typeof opts.comma==="boolean"?opts.comma:defaults.comma,decodeDotInKeys:typeof opts.decodeDotInKeys==="boolean"?opts.decodeDotInKeys:defaults.decodeDotInKeys,decoder:typeof opts.decoder==="function"?opts.decoder:defaults.decoder,delimiter:typeof opts.delimiter==="string"||utils.isRegExp(opts.delimiter)?opts.delimiter:defaults.delimiter,depth:typeof opts.depth==="number"||opts.depth===false?+opts.depth:defaults.depth,duplicates:duplicates,ignoreQueryPrefix:opts.ignoreQueryPrefix===true,interpretNumericEntities:typeof opts.interpretNumericEntities==="boolean"?opts.interpretNumericEntities:defaults.interpretNumericEntities,parameterLimit:typeof opts.parameterLimit==="number"?opts.parameterLimit:defaults.parameterLimit,parseArrays:opts.parseArrays!==false,plainObjects:typeof opts.plainObjects==="boolean"?opts.plainObjects:defaults.plainObjects,strictDepth:typeof opts.strictDepth==="boolean"?!!opts.strictDepth:defaults.strictDepth,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(str,opts){var options=normalizeParseOptions(opts);if(str===""||str===null||typeof str==="undefined"){return options.plainObjects?{__proto__:null}:{}}var tempObj=typeof str==="string"?parseValues(str,options):str;var obj=options.plainObjects?{__proto__:null}:{};var keys=Object.keys(tempObj);for(var i=0;i<keys.length;++i){var key=keys[i];var newObj=parseKeys(key,tempObj[key],options,typeof str==="string");obj=utils.merge(obj,newObj,options)}if(options.allowSparse===true){return obj}return utils.compact(obj)}},{"./utils":43}],42:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var getSideChannel=require("side-channel");var utils=require("./utils");var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var arrayPrefixGenerators={brackets:function brackets(prefix){return prefix+"[]"},comma:"comma",indices:function indices(prefix,key){return prefix+"["+key+"]"},repeat:function repeat(prefix){return prefix}};var isArray=Array.isArray;var push=Array.prototype.push;var pushToArray=function pushToArray(arr,valueOrArray){push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])};var toISO=Date.prototype.toISOString;var defaultFormat=formats["default"];var defaults={addQueryPrefix:false,allowDots:false,allowEmptyArrays:false,arrayFormat:"indices",charset:"utf-8",charsetSentinel:false,commaRoundTrip:false,delimiter:"&",encode:true,encodeDotInKeys:false,encoder:utils.encode,encodeValuesOnly:false,filter:void undefined,format:defaultFormat,formatter:formats.formatters[defaultFormat],indices:false,serializeDate:function serializeDate(date){return toISO.call(date)},skipNulls:false,strictNullHandling:false};var isNonNullishPrimitive=function isNonNullishPrimitive(v){return typeof v==="string"||typeof v==="number"||typeof v==="boolean"||_typeof(v)==="symbol"||typeof v==="bigint"};var sentinel={};var stringify=function stringify(object,prefix,generateArrayPrefix,commaRoundTrip,allowEmptyArrays,strictNullHandling,skipNulls,encodeDotInKeys,encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset,sideChannel){var obj=object;var tmpSc=sideChannel;var step=0;var findFlag=false;while((tmpSc=tmpSc.get(sentinel))!==void undefined&&!findFlag){var pos=tmpSc.get(object);step+=1;if(typeof pos!=="undefined"){if(pos===step){throw new RangeError("Cyclic object value")}else{findFlag=true}}if(typeof tmpSc.get(sentinel)==="undefined"){step=0}}if(typeof filter==="function"){obj=filter(prefix,obj)}else if(obj instanceof Date){obj=serializeDate(obj)}else if(generateArrayPrefix==="comma"&&isArray(obj)){obj=utils.maybeMap(obj,function(value){if(value instanceof Date){return serializeDate(value)}return value})}if(obj===null){if(strictNullHandling){return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset,"key",format):prefix}obj=""}if(isNonNullishPrimitive(obj)||utils.isBuffer(obj)){if(encoder){var keyValue=encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset,"key",format);return[formatter(keyValue)+"="+formatter(encoder(obj,defaults.encoder,charset,"value",format))]}return[formatter(prefix)+"="+formatter(String(obj))]}var values=[];if(typeof obj==="undefined"){return values}var objKeys;if(generateArrayPrefix==="comma"&&isArray(obj)){if(encodeValuesOnly&&encoder){obj=utils.maybeMap(obj,encoder)}objKeys=[{value:obj.length>0?obj.join(",")||null:void undefined}]}else if(isArray(filter)){objKeys=filter}else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}var encodedPrefix=encodeDotInKeys?String(prefix).replace(/\./g,"%2E"):String(prefix);var adjustedPrefix=commaRoundTrip&&isArray(obj)&&obj.length===1?encodedPrefix+"[]":encodedPrefix;if(allowEmptyArrays&&isArray(obj)&&obj.length===0){return adjustedPrefix+"[]"}for(var j=0;j<objKeys.length;++j){var key=objKeys[j];var value=_typeof(key)==="object"&&key&&typeof key.value!=="undefined"?key.value:obj[key];if(skipNulls&&value===null){continue}var encodedKey=allowDots&&encodeDotInKeys?String(key).replace(/\./g,"%2E"):String(key);var keyPrefix=isArray(obj)?typeof generateArrayPrefix==="function"?generateArrayPrefix(adjustedPrefix,encodedKey):adjustedPrefix:adjustedPrefix+(allowDots?"."+encodedKey:"["+encodedKey+"]");sideChannel.set(object,step);var valueSideChannel=getSideChannel();valueSideChannel.set(sentinel,sideChannel);pushToArray(values,stringify(value,keyPrefix,generateArrayPrefix,commaRoundTrip,allowEmptyArrays,strictNullHandling,skipNulls,encodeDotInKeys,generateArrayPrefix==="comma"&&encodeValuesOnly&&isArray(obj)?null:encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset,valueSideChannel))}return values};var normalizeStringifyOptions=function normalizeStringifyOptions(opts){if(!opts){return defaults}if(typeof opts.allowEmptyArrays!=="undefined"&&typeof opts.allowEmptyArrays!=="boolean"){throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided")}if(typeof opts.encodeDotInKeys!=="undefined"&&typeof opts.encodeDotInKeys!=="boolean"){throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided")}if(opts.encoder!==null&&typeof opts.encoder!=="undefined"&&typeof opts.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var charset=opts.charset||defaults.charset;if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var format=formats["default"];if(typeof opts.format!=="undefined"){if(!has.call(formats.formatters,opts.format)){throw new TypeError("Unknown format option provided.")}format=opts.format}var formatter=formats.formatters[format];var filter=defaults.filter;if(typeof opts.filter==="function"||isArray(opts.filter)){filter=opts.filter}var arrayFormat;if(opts.arrayFormat in arrayPrefixGenerators){arrayFormat=opts.arrayFormat}else if("indices"in opts){arrayFormat=opts.indices?"indices":"repeat"}else{arrayFormat=defaults.arrayFormat}if("commaRoundTrip"in opts&&typeof opts.commaRoundTrip!=="boolean"){throw new TypeError("`commaRoundTrip` must be a boolean, or absent")}var allowDots=typeof opts.allowDots==="undefined"?opts.encodeDotInKeys===true?true:defaults.allowDots:!!opts.allowDots;return{addQueryPrefix:typeof opts.addQueryPrefix==="boolean"?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:allowDots,allowEmptyArrays:typeof opts.allowEmptyArrays==="boolean"?!!opts.allowEmptyArrays:defaults.allowEmptyArrays,arrayFormat:arrayFormat,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,commaRoundTrip:!!opts.commaRoundTrip,delimiter:typeof opts.delimiter==="undefined"?defaults.delimiter:opts.delimiter,encode:typeof opts.encode==="boolean"?opts.encode:defaults.encode,encodeDotInKeys:typeof opts.encodeDotInKeys==="boolean"?opts.encodeDotInKeys:defaults.encodeDotInKeys,encoder:typeof opts.encoder==="function"?opts.encoder:defaults.encoder,encodeValuesOnly:typeof opts.encodeValuesOnly==="boolean"?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,format:format,formatter:formatter,serializeDate:typeof opts.serializeDate==="function"?opts.serializeDate:defaults.serializeDate,skipNulls:typeof opts.skipNulls==="boolean"?opts.skipNulls:defaults.skipNulls,sort:typeof opts.sort==="function"?opts.sort:null,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(object,opts){var obj=object;var options=normalizeStringifyOptions(opts);var objKeys;var filter;if(typeof options.filter==="function"){filter=options.filter;obj=filter("",obj)}else if(isArray(options.filter)){filter=options.filter;objKeys=filter}var keys=[];if(_typeof(obj)!=="object"||obj===null){return""}var generateArrayPrefix=arrayPrefixGenerators[options.arrayFormat];var commaRoundTrip=generateArrayPrefix==="comma"&&options.commaRoundTrip;if(!objKeys){objKeys=Object.keys(obj)}if(options.sort){objKeys.sort(options.sort)}var sideChannel=getSideChannel();for(var i=0;i<objKeys.length;++i){var key=objKeys[i];var value=obj[key];if(options.skipNulls&&value===null){continue}pushToArray(keys,stringify(value,key,generateArrayPrefix,commaRoundTrip,options.allowEmptyArrays,options.strictNullHandling,options.skipNulls,options.encodeDotInKeys,options.encode?options.encoder:null,options.filter,options.sort,options.allowDots,options.serializeDate,options.format,options.formatter,options.encodeValuesOnly,options.charset,sideChannel))}var joined=keys.join(options.delimiter);var prefix=options.addQueryPrefix===true?"?":"";if(options.charsetSentinel){if(options.charset==="iso-8859-1"){prefix+="utf8=%26%2310003%3B&"}else{prefix+="utf8=%E2%9C%93&"}}return joined.length>0?prefix+joined:""}},{"./formats":39,"./utils":43,"side-channel":47}],43:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var hexTable=function(){var array=[];for(var i=0;i<256;++i){array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase())}return array}();var compactQueue=function compactQueue(queue){while(queue.length>1){var item=queue.pop();var obj=item.obj[item.prop];if(isArray(obj)){var compacted=[];for(var j=0;j<obj.length;++j){if(typeof obj[j]!=="undefined"){compacted.push(obj[j])}}item.obj[item.prop]=compacted}}};var arrayToObject=function arrayToObject(source,options){var obj=options&&options.plainObjects?{__proto__:null}:{};for(var i=0;i<source.length;++i){if(typeof source[i]!=="undefined"){obj[i]=source[i]}}return obj};var merge=function merge(target,source,options){if(!source){return target}if(_typeof(source)!=="object"&&typeof source!=="function"){if(isArray(target)){target.push(source)}else if(target&&_typeof(target)==="object"){if(options&&(options.plainObjects||options.allowPrototypes)||!has.call(Object.prototype,source)){target[source]=true}}else{return[target,source]}return target}if(!target||_typeof(target)!=="object"){return[target].concat(source)}var mergeTarget=target;if(isArray(target)&&!isArray(source)){mergeTarget=arrayToObject(target,options)}if(isArray(target)&&isArray(source)){source.forEach(function(item,i){if(has.call(target,i)){var targetItem=target[i];if(targetItem&&_typeof(targetItem)==="object"&&item&&_typeof(item)==="object"){target[i]=merge(targetItem,item,options)}else{target.push(item)}}else{target[i]=item}});return target}return Object.keys(source).reduce(function(acc,key){var value=source[key];if(has.call(acc,key)){acc[key]=merge(acc[key],value,options)}else{acc[key]=value}return acc},mergeTarget)};var assign=function assignSingleSource(target,source){return Object.keys(source).reduce(function(acc,key){acc[key]=source[key];return acc},target)};var decode=function decode(str,defaultDecoder,charset){var strWithoutPlus=str.replace(/\+/g," ");if(charset==="iso-8859-1"){return strWithoutPlus.replace(/%[0-9a-f]{2}/gi,unescape)}try{return decodeURIComponent(strWithoutPlus)}catch(e){return strWithoutPlus}};var limit=1024;var encode=function encode(str,defaultEncoder,charset,kind,format){if(str.length===0){return str}var string=str;if(_typeof(str)==="symbol"){string=Symbol.prototype.toString.call(str)}else if(typeof str!=="string"){string=String(str)}if(charset==="iso-8859-1"){return escape(string).replace(/%u[0-9a-f]{4}/gi,function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"})}var out="";for(var j=0;j<string.length;j+=limit){var segment=string.length>=limit?string.slice(j,j+limit):string;var arr=[];for(var i=0;i<segment.length;++i){var c=segment.charCodeAt(i);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||format===formats.RFC1738&&(c===40||c===41)){arr[arr.length]=segment.charAt(i);continue}if(c<128){arr[arr.length]=hexTable[c];continue}if(c<2048){arr[arr.length]=hexTable[192|c>>6]+hexTable[128|c&63];continue}if(c<55296||c>=57344){arr[arr.length]=hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|c&63];continue}i+=1;c=65536+((c&1023)<<10|segment.charCodeAt(i)&1023);arr[arr.length]=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|c&63]}out+=arr.join("")}return out};var compact=function compact(value){var queue=[{obj:{o:value},prop:"o"}];var refs=[];for(var i=0;i<queue.length;++i){var item=queue[i];var obj=item.obj[item.prop];var keys=Object.keys(obj);for(var j=0;j<keys.length;++j){var key=keys[j];var val=obj[key];if(_typeof(val)==="object"&&val!==null&&refs.indexOf(val)===-1){queue.push({obj:obj,prop:key});refs.push(val)}}}compactQueue(queue);return value};var isRegExp=function isRegExp(obj){return Object.prototype.toString.call(obj)==="[object RegExp]"};var isBuffer=function isBuffer(obj){if(!obj||_typeof(obj)!=="object"){return false}return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))};var combine=function combine(a,b){return[].concat(a,b)};var maybeMap=function maybeMap(val,fn){if(isArray(val)){var mapped=[];for(var i=0;i<val.length;i+=1){mapped.push(fn(val[i]))}return mapped}return fn(val)};module.exports={arrayToObject:arrayToObject,assign:assign,combine:combine,compact:compact,decode:decode,encode:encode,isBuffer:isBuffer,isRegExp:isRegExp,maybeMap:maybeMap,merge:merge}},{"./formats":39}],44:[function(require,module,exports){"use strict";var inspect=require("object-inspect");var $TypeError=require("es-errors/type");var listGetNode=function listGetNode(list,key,isDelete){var prev=list;var curr;for(;(curr=prev.next)!=null;prev=curr){if(curr.key===key){prev.next=curr.next;if(!isDelete){curr.next=list.next;list.next=curr}return curr}}};var listGet=function listGet(objects,key){if(!objects){return void undefined}var node=listGetNode(objects,key);return node&&node.value};var listSet=function listSet(objects,key,value){var node=listGetNode(objects,key);if(node){node.value=value}else{objects.next={key:key,next:objects.next,value:value}}};var listHas=function listHas(objects,key){if(!objects){return false}return!!listGetNode(objects,key)};var listDelete=function listDelete(objects,key){if(objects){return listGetNode(objects,key,true)}};module.exports=function getSideChannelList(){var $o;var channel={assert:function assert(key){if(!channel.has(key)){throw new $TypeError("Side channel does not contain "+inspect(key))}},delete:function _delete(key){var root=$o&&$o.next;var deletedNode=listDelete($o,key);if(deletedNode&&root&&root===deletedNode){$o=void undefined}return!!deletedNode},get:function get(key){return listGet($o,key)},has:function has(key){return listHas($o,key)},set:function set(key,value){if(!$o){$o={next:void undefined}}listSet($o,key,value)}};return channel}},{"es-errors/type":16,"object-inspect":38}],45:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBound=require("call-bound");var inspect=require("object-inspect");var $TypeError=require("es-errors/type");var $Map=GetIntrinsic("%Map%",true);var $mapGet=callBound("Map.prototype.get",true);var $mapSet=callBound("Map.prototype.set",true);var $mapHas=callBound("Map.prototype.has",true);var $mapDelete=callBound("Map.prototype.delete",true);var $mapSize=callBound("Map.prototype.size",true);module.exports=!!$Map&&function getSideChannelMap(){var $m;var channel={assert:function assert(key){if(!channel.has(key)){throw new $TypeError("Side channel does not contain "+inspect(key))}},delete:function _delete(key){if($m){var result=$mapDelete($m,key);if($mapSize($m)===0){$m=void undefined}return result}return false},get:function get(key){if($m){return $mapGet($m,key)}},has:function has(key){if($m){return $mapHas($m,key)}return false},set:function set(key,value){if(!$m){$m=new $Map}$mapSet($m,key,value)}};return channel}},{"call-bound":7,"es-errors/type":16,"get-intrinsic":21,"object-inspect":38}],46:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var GetIntrinsic=require("get-intrinsic");var callBound=require("call-bound");var inspect=require("object-inspect");var getSideChannelMap=require("side-channel-map");var $TypeError=require("es-errors/type");var $WeakMap=GetIntrinsic("%WeakMap%",true);var $weakMapGet=callBound("WeakMap.prototype.get",true);var $weakMapSet=callBound("WeakMap.prototype.set",true);var $weakMapHas=callBound("WeakMap.prototype.has",true);var $weakMapDelete=callBound("WeakMap.prototype.delete",true);module.exports=$WeakMap?function getSideChannelWeakMap(){var $wm;var $m;var channel={assert:function assert(key){if(!channel.has(key)){throw new $TypeError("Side channel does not contain "+inspect(key))}},delete:function _delete(key){if($WeakMap&&key&&(_typeof(key)==="object"||typeof key==="function")){if($wm){return $weakMapDelete($wm,key)}}else if(getSideChannelMap){if($m){return $m["delete"](key)}}return false},get:function get(key){if($WeakMap&&key&&(_typeof(key)==="object"||typeof key==="function")){if($wm){return $weakMapGet($wm,key)}}return $m&&$m.get(key)},has:function has(key){if($WeakMap&&key&&(_typeof(key)==="object"||typeof key==="function")){if($wm){return $weakMapHas($wm,key)}}return!!$m&&$m.has(key)},set:function set(key,value){if($WeakMap&&key&&(_typeof(key)==="object"||typeof key==="function")){if(!$wm){$wm=new $WeakMap}$weakMapSet($wm,key,value)}else if(getSideChannelMap){if(!$m){$m=getSideChannelMap()}$m.set(key,value)}}};return channel}:getSideChannelMap},{"call-bound":7,"es-errors/type":16,"get-intrinsic":21,"object-inspect":38,"side-channel-map":45}],47:[function(require,module,exports){"use strict";var $TypeError=require("es-errors/type");var inspect=require("object-inspect");var getSideChannelList=require("side-channel-list");var getSideChannelMap=require("side-channel-map");var getSideChannelWeakMap=require("side-channel-weakmap");var makeChannel=getSideChannelWeakMap||getSideChannelMap||getSideChannelList;module.exports=function getSideChannel(){var $channelData;var channel={assert:function assert(key){if(!channel.has(key)){throw new $TypeError("Side channel does not contain "+inspect(key))}},delete:function _delete(key){return!!$channelData&&$channelData["delete"](key)},get:function get(key){return $channelData&&$channelData.get(key)},has:function has(key){return!!$channelData&&$channelData.has(key)},set:function set(key,value){if(!$channelData){$channelData=makeChannel()}$channelData.set(key,value)}};return channel}},{"es-errors/type":16,"object-inspect":38,"side-channel-list":44,"side-channel-map":45,"side-channel-weakmap":46}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NIL",{enumerable:true,get:function get(){return _nil["default"]}});Object.defineProperty(exports,"parse",{enumerable:true,get:function get(){return _parse["default"]}});Object.defineProperty(exports,"stringify",{enumerable:true,get:function get(){return _stringify["default"]}});Object.defineProperty(exports,"v1",{enumerable:true,get:function get(){return _v["default"]}});Object.defineProperty(exports,"v3",{enumerable:true,get:function get(){return _v2["default"]}});Object.defineProperty(exports,"v4",{enumerable:true,get:function get(){return _v3["default"]}});Object.defineProperty(exports,"v5",{enumerable:true,get:function get(){return _v4["default"]}});Object.defineProperty(exports,"validate",{enumerable:true,get:function get(){return _validate["default"]}});Object.defineProperty(exports,"version",{enumerable:true,get:function get(){return _version["default"]}});var _v=_interopRequireDefault(require("./v1.js"));var _v2=_interopRequireDefault(require("./v3.js"));var _v3=_interopRequireDefault(require("./v4.js"));var _v4=_interopRequireDefault(require("./v5.js"));var _nil=_interopRequireDefault(require("./nil.js"));var _version=_interopRequireDefault(require("./version.js"));var _validate=_interopRequireDefault(require("./validate.js"));var _stringify=_interopRequireDefault(require("./stringify.js"));var _parse=_interopRequireDefault(require("./parse.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./nil.js":51,"./parse.js":52,"./stringify.js":56,"./v1.js":57,"./v3.js":58,"./v4.js":60,"./v5.js":61,"./validate.js":62,"./version.js":63}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function md5(bytes){if(typeof bytes==="string"){var msg=unescape(encodeURIComponent(bytes));bytes=new Uint8Array(msg.length);for(var i=0;i<msg.length;++i){bytes[i]=msg.charCodeAt(i)}}return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes),bytes.length*8))}function md5ToHexEncodedArray(input){var output=[];var length32=input.length*32;var hexTab="0123456789abcdef";for(var i=0;i<length32;i+=8){var x=input[i>>5]>>>i%32&255;var hex=parseInt(hexTab.charAt(x>>>4&15)+hexTab.charAt(x&15),16);output.push(hex)}return output}function getOutputLength(inputLength8){return(inputLength8+64>>>9<<4)+14+1}function wordsToMd5(x,len){x[len>>5]|=128<<len%32;x[getOutputLength(len)-1]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=md5ff(a,b,c,d,x[i],7,-680876936);d=md5ff(d,a,b,c,x[i+1],12,-389564586);c=md5ff(c,d,a,b,x[i+2],17,606105819);b=md5ff(b,c,d,a,x[i+3],22,-1044525330);a=md5ff(a,b,c,d,x[i+4],7,-176418897);d=md5ff(d,a,b,c,x[i+5],12,1200080426);c=md5ff(c,d,a,b,x[i+6],17,-1473231341);b=md5ff(b,c,d,a,x[i+7],22,-45705983);a=md5ff(a,b,c,d,x[i+8],7,1770035416);d=md5ff(d,a,b,c,x[i+9],12,-1958414417);c=md5ff(c,d,a,b,x[i+10],17,-42063);b=md5ff(b,c,d,a,x[i+11],22,-1990404162);a=md5ff(a,b,c,d,x[i+12],7,1804603682);d=md5ff(d,a,b,c,x[i+13],12,-40341101);c=md5ff(c,d,a,b,x[i+14],17,-1502002290);b=md5ff(b,c,d,a,x[i+15],22,1236535329);a=md5gg(a,b,c,d,x[i+1],5,-165796510);d=md5gg(d,a,b,c,x[i+6],9,-1069501632);c=md5gg(c,d,a,b,x[i+11],14,643717713);b=md5gg(b,c,d,a,x[i],20,-373897302);a=md5gg(a,b,c,d,x[i+5],5,-701558691);d=md5gg(d,a,b,c,x[i+10],9,38016083);c=md5gg(c,d,a,b,x[i+15],14,-660478335);b=md5gg(b,c,d,a,x[i+4],20,-405537848);a=md5gg(a,b,c,d,x[i+9],5,568446438);d=md5gg(d,a,b,c,x[i+14],9,-1019803690);c=md5gg(c,d,a,b,x[i+3],14,-187363961);b=md5gg(b,c,d,a,x[i+8],20,1163531501);a=md5gg(a,b,c,d,x[i+13],5,-1444681467);d=md5gg(d,a,b,c,x[i+2],9,-51403784);c=md5gg(c,d,a,b,x[i+7],14,1735328473);b=md5gg(b,c,d,a,x[i+12],20,-1926607734);a=md5hh(a,b,c,d,x[i+5],4,-378558);d=md5hh(d,a,b,c,x[i+8],11,-2022574463);c=md5hh(c,d,a,b,x[i+11],16,1839030562);b=md5hh(b,c,d,a,x[i+14],23,-35309556);a=md5hh(a,b,c,d,x[i+1],4,-1530992060);d=md5hh(d,a,b,c,x[i+4],11,1272893353);c=md5hh(c,d,a,b,x[i+7],16,-155497632);b=md5hh(b,c,d,a,x[i+10],23,-1094730640);a=md5hh(a,b,c,d,x[i+13],4,681279174);d=md5hh(d,a,b,c,x[i],11,-358537222);c=md5hh(c,d,a,b,x[i+3],16,-722521979);b=md5hh(b,c,d,a,x[i+6],23,76029189);a=md5hh(a,b,c,d,x[i+9],4,-640364487);d=md5hh(d,a,b,c,x[i+12],11,-421815835);c=md5hh(c,d,a,b,x[i+15],16,530742520);b=md5hh(b,c,d,a,x[i+2],23,-995338651);a=md5ii(a,b,c,d,x[i],6,-198630844);d=md5ii(d,a,b,c,x[i+7],10,1126891415);c=md5ii(c,d,a,b,x[i+14],15,-1416354905);b=md5ii(b,c,d,a,x[i+5],21,-57434055);a=md5ii(a,b,c,d,x[i+12],6,1700485571);d=md5ii(d,a,b,c,x[i+3],10,-1894986606);c=md5ii(c,d,a,b,x[i+10],15,-1051523);b=md5ii(b,c,d,a,x[i+1],21,-2054922799);a=md5ii(a,b,c,d,x[i+8],6,1873313359);d=md5ii(d,a,b,c,x[i+15],10,-30611744);c=md5ii(c,d,a,b,x[i+6],15,-1560198380);b=md5ii(b,c,d,a,x[i+13],21,1309151649);a=md5ii(a,b,c,d,x[i+4],6,-145523070);d=md5ii(d,a,b,c,x[i+11],10,-1120210379);c=md5ii(c,d,a,b,x[i+2],15,718787259);b=md5ii(b,c,d,a,x[i+9],21,-343485551);a=safeAdd(a,olda);b=safeAdd(b,oldb);c=safeAdd(c,oldc);d=safeAdd(d,oldd)}return[a,b,c,d]}function bytesToWords(input){if(input.length===0){return[]}var length8=input.length*8;var output=new Uint32Array(getOutputLength(length8));for(var i=0;i<length8;i+=8){output[i>>5]|=(input[i/8]&255)<<i%32}return output}function safeAdd(x,y){var lsw=(x&65535)+(y&65535);var msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535}function bitRotateLeft(num,cnt){return num<<cnt|num>>>32-cnt}function md5cmn(q,a,b,x,s,t){return safeAdd(bitRotateLeft(safeAdd(safeAdd(a,q),safeAdd(x,t)),s),b)}function md5ff(a,b,c,d,x,s,t){return md5cmn(b&c|~b&d,a,b,x,s,t)}function md5gg(a,b,c,d,x,s,t){return md5cmn(b&d|c&~d,a,b,x,s,t)}function md5hh(a,b,c,d,x,s,t){return md5cmn(b^c^d,a,b,x,s,t)}function md5ii(a,b,c,d,x,s,t){return md5cmn(c^(b|~d),a,b,x,s,t)}var _default=md5;exports["default"]=_default},{}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var randomUUID=typeof crypto!=="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var _default={randomUUID:randomUUID};exports["default"]=_default},{}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _default="00000000-0000-0000-0000-000000000000";exports["default"]=_default},{}],52:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _validate=_interopRequireDefault(require("./validate.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function parse(uuid){if(!(0,_validate["default"])(uuid)){throw TypeError("Invalid UUID")}var v;var arr=new Uint8Array(16);arr[0]=(v=parseInt(uuid.slice(0,8),16))>>>24;arr[1]=v>>>16&255;arr[2]=v>>>8&255;arr[3]=v&255;arr[4]=(v=parseInt(uuid.slice(9,13),16))>>>8;arr[5]=v&255;arr[6]=(v=parseInt(uuid.slice(14,18),16))>>>8;arr[7]=v&255;arr[8]=(v=parseInt(uuid.slice(19,23),16))>>>8;arr[9]=v&255;arr[10]=(v=parseInt(uuid.slice(24,36),16))/1099511627776&255;arr[11]=v/4294967296&255;arr[12]=v>>>24&255;arr[13]=v>>>16&255;arr[14]=v>>>8&255;arr[15]=v&255;return arr}var _default=parse;exports["default"]=_default},{"./validate.js":62}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;exports["default"]=_default},{}],54:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=rng;var getRandomValues;var rnds8=new Uint8Array(16);function rng(){if(!getRandomValues){getRandomValues=typeof crypto!=="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto);if(!getRandomValues){throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")}}return getRandomValues(rnds8)}},{}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function f(s,x,y,z){switch(s){case 0:return x&y^~x&z;case 1:return x^y^z;case 2:return x&y^x&z^y&z;case 3:return x^y^z}}function ROTL(x,n){return x<<n|x>>>32-n}function sha1(bytes){var K=[1518500249,1859775393,2400959708,3395469782];var H=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof bytes==="string"){var msg=unescape(encodeURIComponent(bytes));bytes=[];for(var i=0;i<msg.length;++i){bytes.push(msg.charCodeAt(i))}}else if(!Array.isArray(bytes)){bytes=Array.prototype.slice.call(bytes)}bytes.push(128);var l=bytes.length/4+2;var N=Math.ceil(l/16);var M=new Array(N);for(var _i=0;_i<N;++_i){var arr=new Uint32Array(16);for(var j=0;j<16;++j){arr[j]=bytes[_i*64+j*4]<<24|bytes[_i*64+j*4+1]<<16|bytes[_i*64+j*4+2]<<8|bytes[_i*64+j*4+3]}M[_i]=arr}M[N-1][14]=(bytes.length-1)*8/Math.pow(2,32);M[N-1][14]=Math.floor(M[N-1][14]);M[N-1][15]=(bytes.length-1)*8&4294967295;for(var _i2=0;_i2<N;++_i2){var W=new Uint32Array(80);for(var t=0;t<16;++t){W[t]=M[_i2][t]}for(var _t=16;_t<80;++_t){W[_t]=ROTL(W[_t-3]^W[_t-8]^W[_t-14]^W[_t-16],1)}var a=H[0];var b=H[1];var c=H[2];var d=H[3];var e=H[4];for(var _t2=0;_t2<80;++_t2){var s=Math.floor(_t2/20);var T=ROTL(a,5)+f(s,b,c,d)+e+K[s]+W[_t2]>>>0;e=d;d=c;c=ROTL(b,30)>>>0;b=a;a=T}H[0]=H[0]+a>>>0;H[1]=H[1]+b>>>0;H[2]=H[2]+c>>>0;H[3]=H[3]+d>>>0;H[4]=H[4]+e>>>0}return[H[0]>>24&255,H[0]>>16&255,H[0]>>8&255,H[0]&255,H[1]>>24&255,H[1]>>16&255,H[1]>>8&255,H[1]&255,H[2]>>24&255,H[2]>>16&255,H[2]>>8&255,H[2]&255,H[3]>>24&255,H[3]>>16&255,H[3]>>8&255,H[3]&255,H[4]>>24&255,H[4]>>16&255,H[4]>>8&255,H[4]&255]}var _default=sha1;exports["default"]=_default},{}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;exports.unsafeStringify=unsafeStringify;var _validate=_interopRequireDefault(require("./validate.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var byteToHex=[];for(var i=0;i<256;++i){byteToHex.push((i+256).toString(16).slice(1))}function unsafeStringify(arr){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return byteToHex[arr[offset+0]]+byteToHex[arr[offset+1]]+byteToHex[arr[offset+2]]+byteToHex[arr[offset+3]]+"-"+byteToHex[arr[offset+4]]+byteToHex[arr[offset+5]]+"-"+byteToHex[arr[offset+6]]+byteToHex[arr[offset+7]]+"-"+byteToHex[arr[offset+8]]+byteToHex[arr[offset+9]]+"-"+byteToHex[arr[offset+10]]+byteToHex[arr[offset+11]]+byteToHex[arr[offset+12]]+byteToHex[arr[offset+13]]+byteToHex[arr[offset+14]]+byteToHex[arr[offset+15]]}function stringify(arr){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var uuid=unsafeStringify(arr,offset);if(!(0,_validate["default"])(uuid)){throw TypeError("Stringified UUID is invalid")}return uuid}var _default=stringify;exports["default"]=_default},{"./validate.js":62}],57:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _rng=_interopRequireDefault(require("./rng.js"));var _stringify=require("./stringify.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _nodeId;var _clockseq;var _lastMSecs=0;var _lastNSecs=0;function v1(options,buf,offset){var i=buf&&offset||0;var b=buf||new Array(16);options=options||{};var node=options.node||_nodeId;var clockseq=options.clockseq!==undefined?options.clockseq:_clockseq;if(node==null||clockseq==null){var seedBytes=options.random||(options.rng||_rng["default"])();if(node==null){node=_nodeId=[seedBytes[0]|1,seedBytes[1],seedBytes[2],seedBytes[3],seedBytes[4],seedBytes[5]]}if(clockseq==null){clockseq=_clockseq=(seedBytes[6]<<8|seedBytes[7])&16383}}var msecs=options.msecs!==undefined?options.msecs:Date.now();var nsecs=options.nsecs!==undefined?options.nsecs:_lastNSecs+1;var dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&options.clockseq===undefined){clockseq=clockseq+1&16383}if((dt<0||msecs>_lastMSecs)&&options.nsecs===undefined){nsecs=0}if(nsecs>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}_lastMSecs=msecs;_lastNSecs=nsecs;_clockseq=clockseq;msecs+=122192928e5;var tl=((msecs&268435455)*1e4+nsecs)%4294967296;b[i++]=tl>>>24&255;b[i++]=tl>>>16&255;b[i++]=tl>>>8&255;b[i++]=tl&255;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255;b[i++]=tmh&255;b[i++]=tmh>>>24&15|16;b[i++]=tmh>>>16&255;b[i++]=clockseq>>>8|128;b[i++]=clockseq&255;for(var n=0;n<6;++n){b[i+n]=node[n]}return buf||(0,_stringify.unsafeStringify)(b)}var _default=v1;exports["default"]=_default},{"./rng.js":54,"./stringify.js":56}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _v=_interopRequireDefault(require("./v35.js"));var _md=_interopRequireDefault(require("./md5.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var v3=(0,_v["default"])("v3",48,_md["default"]);var _default=v3;exports["default"]=_default},{"./md5.js":49,"./v35.js":59}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.URL=exports.DNS=void 0;exports["default"]=v35;var _stringify=require("./stringify.js");var _parse=_interopRequireDefault(require("./parse.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function stringToBytes(str){str=unescape(encodeURIComponent(str));var bytes=[];for(var i=0;i<str.length;++i){bytes.push(str.charCodeAt(i))}return bytes}var DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";exports.DNS=DNS;var URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";exports.URL=URL;function v35(name,version,hashfunc){function generateUUID(value,namespace,buf,offset){var _namespace;if(typeof value==="string"){value=stringToBytes(value)}if(typeof namespace==="string"){namespace=(0,_parse["default"])(namespace)}if(((_namespace=namespace)===null||_namespace===void 0?void 0:_namespace.length)!==16){throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)")}var bytes=new Uint8Array(16+value.length);bytes.set(namespace);bytes.set(value,namespace.length);bytes=hashfunc(bytes);bytes[6]=bytes[6]&15|version;bytes[8]=bytes[8]&63|128;if(buf){offset=offset||0;for(var i=0;i<16;++i){buf[offset+i]=bytes[i]}return buf}return(0,_stringify.unsafeStringify)(bytes)}try{generateUUID.name=name}catch(err){}generateUUID.DNS=DNS;generateUUID.URL=URL;return generateUUID}},{"./parse.js":52,"./stringify.js":56}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _native=_interopRequireDefault(require("./native.js"));var _rng=_interopRequireDefault(require("./rng.js"));var _stringify=require("./stringify.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function v4(options,buf,offset){if(_native["default"].randomUUID&&!buf&&!options){return _native["default"].randomUUID()}options=options||{};var rnds=options.random||(options.rng||_rng["default"])();rnds[6]=rnds[6]&15|64;rnds[8]=rnds[8]&63|128;if(buf){offset=offset||0;for(var i=0;i<16;++i){buf[offset+i]=rnds[i]}return buf}return(0,_stringify.unsafeStringify)(rnds)}var _default=v4;exports["default"]=_default},{"./native.js":50,"./rng.js":54,"./stringify.js":56}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _v=_interopRequireDefault(require("./v35.js"));var _sha=_interopRequireDefault(require("./sha1.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var v5=(0,_v["default"])("v5",80,_sha["default"]);var _default=v5;exports["default"]=_default},{"./sha1.js":55,"./v35.js":59}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _regex=_interopRequireDefault(require("./regex.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function validate(uuid){return typeof uuid==="string"&&_regex["default"].test(uuid)}var _default=validate;exports["default"]=_default},{"./regex.js":53}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _validate=_interopRequireDefault(require("./validate.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function version(uuid){if(!(0,_validate["default"])(uuid)){throw TypeError("Invalid UUID")}return parseInt(uuid.slice(14,15),16)}var _default=version;exports["default"]=_default},{"./validate.js":62}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var collect_1=require("./collect");if(typeof window!=="undefined"){window.TokenizeJs=collect_1.TokenizeJs}},{"./collect":65}],65:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(h).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)})}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.TokenizeJs=void 0;var uuid_1=require("uuid");var constants=__importStar(require("./lib/constants"));var shared_1=__importDefault(require("./lib/services/shared"));var applepay_1=__importDefault(require("./lib/services/applepay"));var googlepay_1=__importDefault(require("./lib/services/googlepay"));var paze_1=__importDefault(require("./lib/services/paze"));var card_on_file_1=__importDefault(require("./lib/services/card-on-file"));var helpers=__importStar(require("./lib/helpers/common"));var TokenizeJs=function(){function TokenizeJs(businessId,applicationId,walletRequest){_classCallCheck(this,TokenizeJs);this.sharedService=new shared_1["default"](businessId,applicationId,walletRequest);this.applePayService=new applepay_1["default"](this.sharedService);this.googlePayService=new googlepay_1["default"](this.sharedService);this.pazeService=new paze_1["default"](this.sharedService);this.cardOnFileService=new card_on_file_1["default"](this.sharedService)}return _createClass(TokenizeJs,[{key:"on",value:function on(eventName,callback){this.sharedService.on(eventName,callback)}},{key:"mount",value:function mount(domElement,document,mountOptions){var _a,_b,_c;var options=helpers.getAllOptions(this.sharedService.businessId,this.sharedService.applicationId,this.sharedService.sessionId,mountOptions);if(options.enableCardOnFile){this.cardOnFileService.mount(options.locale,options.forceSaveCardOnFile,options.cardAgreementOptions)}var isPaymentFormEnabled=helpers.isPaymentFormEnabled(options);var applePay=(_a=options.paymentMethods)===null||_a===void 0?void 0:_a.includes("apple_pay");var googlePay=(_b=options.paymentMethods)===null||_b===void 0?void 0:_b.includes("google_pay");var paze=(_c=options.paymentMethods)===null||_c===void 0?void 0:_c.includes("paze");if(isPaymentFormEnabled){this.sharedService.mountPaymentForm(domElement,document,options)}if(applePay||googlePay||paze){this.sharedService.mountButtonsContainer(domElement,document,options);if(applePay){this.applePayService.mount(options.buttonOptions,options.applePayButtonOptions)}if(googlePay){this.googlePayService.mount(options.buttonOptions,options.googlePayButtonOptions)}if(paze){this.pazeService.mount(options.buttonOptions,options.pazeButtonOptions)}}if(!isPaymentFormEnabled){this.sharedService.processCallbacks("ready",{type:"ready",data:{}});this.sharedService.processCallbacks("iframe_ready",{type:"iframe_ready",data:{}})}}},{key:"unmount",value:function unmount(domElement,document){this.sharedService.unmount(domElement,document);this.cardOnFileService.unmount()}},{key:"getIFrame",value:function getIFrame(){return this.sharedService.iFrame}},{key:"reload",value:function reload(){var _a,_b;(_b=(_a=this.sharedService.iFrame)===null||_a===void 0?void 0:_a.contentWindow)===null||_b===void 0?void 0:_b.location.reload()}},{key:"getNonce",value:function getNonce(){var getNonceOptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.sharedService.iFrame){return this.sharedService.handleError("CARD_PAYMENT",new Error("iFrame not found"))}getNonceOptions.requestId=(0,uuid_1.v4)();if(this.cardOnFileService.cardAgreementData){getNonceOptions.cardAgreementMetadata=this.cardOnFileService.cardAgreementData.metadata}this.sharedService.postIFrameMessage({type:"op_get_nonce",options:getNonceOptions})}},{key:"startGooglePaySession",value:function startGooglePaySession(walletRequest){this.googlePayService.startSession(walletRequest)}},{key:"startApplePaySession",value:function startApplePaySession(walletRequest){this.applePayService.startSession(walletRequest)}},{key:"startPazeSession",value:function startPazeSession(walletRequest){this.pazeService.startSession(walletRequest)}},{key:"abortApplePaySession",value:function abortApplePaySession(){this.applePayService.abortSession()}},{key:"supportWalletPayments",value:function supportWalletPayments(){return __awaiter(this,arguments,void 0,function(){var _this=this;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return _regeneratorRuntime().mark(function _callee(){var result,domainName,promises;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:result={googlePay:false,applePay:false,paze:false};domainName=helpers.getSourceAppHostname();if(!constants.DOMAIN_BLACKLIST.includes(domainName)){_context.next=5;break}_this.sharedService.handleError("WALLET",new Error(domainName+" is blacklisted. Please reach out GDP support."));return _context.abrupt("return",result);case 5:_context.prev=5;promises=[_this.applePayService.initialize(),_this.googlePayService.initialize(),_this.pazeService.initialize(options.emailAddress)];_context.next=9;return Promise.all(promises);case 9:result.applePay=_this.applePayService.isReady();result.googlePay=_this.googlePayService.isReady();result.paze=_this.pazeService.isReady();_context.next=17;break;case 14:_context.prev=14;_context.t0=_context["catch"](5);_this.sharedService.handleError("WALLET",_context.t0);case 17:return _context.abrupt("return",result);case 18:case"end":return _context.stop()}},_callee,null,[[5,14]])})()})}}])}();exports.TokenizeJs=TokenizeJs},{"./lib/constants":67,"./lib/helpers/common":70,"./lib/services/applepay":75,"./lib/services/card-on-file":76,"./lib/services/googlepay":77,"./lib/services/paze":78,"./lib/services/shared":79,uuid:48}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.declineButton=exports.acceptButton=exports.actionButtonsContainer=exports.businessPhoneText=exports.businessWebsiteLink=exports.businessNameText=exports.mainText=exports.closeIcon=exports.closeIconContainer=exports.title=exports.agreementContainer=exports.globalContainer=void 0;exports.globalContainer={position:"fixed",top:"0",left:"0",width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center","background-color":"rgb(186 166 192 / 50%)","z-index":"9999"};exports.agreementContainer={"max-width":"600px",width:"100%","background-color":"#ffffff","font-family":"Roboto, Open Sans, Segoe UI, sans-serif",padding:"20px 40px 40px 40px","border-radius":"10px"};exports.title={"font-size":"1.2rem","font-weight":"bold","margin-bottom":"10px"};exports.closeIconContainer={"text-align":"right"};exports.closeIcon={"font-size":"1.6rem",cursor:"pointer",color:"#8a8a8a"};exports.mainText={"font-size":"1rem"};exports.businessNameText={"font-weight":"bold"};exports.businessWebsiteLink={"text-decoration":"underline",color:"#0946ED"};exports.businessPhoneText={"font-style":"italic"};exports.actionButtonsContainer={display:"flex","justify-content":"center","align-items":"center","flex-wrap":"wrap",gap:"10px","margin-top":"20px"};exports.acceptButton={padding:"10px 50px","background-color":"#0946ED","border-radius":"15px",color:"#ffffff","max-width":"200px",width:"100%"};exports.declineButton={padding:"10px 50px","background-color":"#627792","border-radius":"15px",color:"#ffffff","max-width":"200px",width:"100%"}},{}],67:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:true});exports.GODADDY_CONTACT_LINK=exports.GODADDY_CONTACT_PHONE=exports.COF_DEFAULT_COUNTRY_CODE=exports.COF_DEFAULT_LANGUAGE=exports.ASSETS_CDN_URL=exports.DOMAIN_BLACKLIST=exports.WALLET_SHIPPING_COUNTRY_CODES=exports.DEFAULT_TIMEOUT=exports.PAZE_ALLOWED_CARD_NETWORKS=exports.APPLEPAY_SUPPORTED_NETWORKS=exports.APPLEPAY_MERCHANT_CAPABILITIES=exports.APPLEPAY_VERSION=exports.GOOGLEPAY_ALLOWED_CARD_NETWORKS=exports.GOOGLEPAY_ALLOWED_AUTHN_METHODS=exports.GOOGLEPAY_VERSION_MINOR=exports.GOOGLEPAY_VERSION=exports.GOOGLEPAY_GATEWAY=exports.GOOGLEPAY_MERCHANT_ID=exports.GOOGLEPAY_SCRIPT_URL=exports.GOOGLE_PAY_INTENT_MAP=exports.GOOGLE_PAY_EVENT_MAP=exports.DEFAULT_LOCALE=exports.IFRAME_NAME=void 0;exports.IFRAME_NAME="poynt-collect-v2-iframe";exports.DEFAULT_LOCALE="en-US";exports.GOOGLE_PAY_EVENT_MAP=_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"INITIALIZE","shipping_address_change"),"SHIPPING_ADDRESS","shipping_address_change"),"SHIPPING_OPTION","shipping_method_change"),"OFFER","coupon_code_change");exports.GOOGLE_PAY_INTENT_MAP=_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"INITIALIZE","SHIPPING_ADDRESS"),"SHIPPING_ADDRESS","SHIPPING_ADDRESS"),"SHIPPING_OPTION","SHIPPING_OPTION"),"OFFER","OFFER");exports.GOOGLEPAY_SCRIPT_URL="https://pay.google.com/gp/p/js/pay.js";exports.GOOGLEPAY_MERCHANT_ID="BCR2DN4T3D32TPA6";exports.GOOGLEPAY_GATEWAY="godaddypayments";exports.GOOGLEPAY_VERSION=2;exports.GOOGLEPAY_VERSION_MINOR=0;exports.GOOGLEPAY_ALLOWED_AUTHN_METHODS=["PAN_ONLY","CRYPTOGRAM_3DS"];exports.GOOGLEPAY_ALLOWED_CARD_NETWORKS=["AMEX","DISCOVER","JCB","MASTERCARD","VISA"];exports.APPLEPAY_VERSION=6;exports.APPLEPAY_MERCHANT_CAPABILITIES=["supports3DS"];exports.APPLEPAY_SUPPORTED_NETWORKS=["visa","masterCard","amex","discover","interac"];exports.PAZE_ALLOWED_CARD_NETWORKS=["VISA","MASTERCARD"];exports.DEFAULT_TIMEOUT=15e3;exports.WALLET_SHIPPING_COUNTRY_CODES=[];exports.DOMAIN_BLACKLIST=["websites.godaddy.com"];exports.ASSETS_CDN_URL="https://d85ecz8votkqa.cloudfront.net/images/collect/";exports.COF_DEFAULT_LANGUAGE="EN";exports.COF_DEFAULT_COUNTRY_CODE="US";exports.GODADDY_CONTACT_PHONE="+1 480-463-8300";exports.GODADDY_CONTACT_LINK="https://www.godaddy.com/help/contact-us"},{}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildMaskedPaymentRequest=exports.buildPaymentRequest=exports.buildWalletNonceError=exports.buildErrors=exports.buildShippingMethods=exports.buildTotal=exports.buildLineItems=void 0;var constants_1=require("../constants");var buildLineItems=function buildLineItems(request){if(!request.lineItems){return[]}return request.lineItems.map(function(_ref){var label=_ref.label,amount=_ref.amount,isPending=_ref.isPending;return{label:label,amount:amount,type:isPending?"pending":"final"}})};exports.buildLineItems=buildLineItems;var buildTotal=function buildTotal(request){if(!request.total){return{label:"",amount:"0.00"}}return{label:request.total.label,amount:request.total.amount,type:request.total.isPending?"pending":"final"}};exports.buildTotal=buildTotal;var buildShippingMethods=function buildShippingMethods(request){var _a;if(!((_a=request.shippingMethods)===null||_a===void 0?void 0:_a.length)){return}return request.shippingMethods.map(function(_ref2){var id=_ref2.id,label=_ref2.label,amount=_ref2.amount,detail=_ref2.detail;return{identifier:id,label:label,amount:amount,detail:detail}})};exports.buildShippingMethods=buildShippingMethods;var buildErrors=function buildErrors(request){var errorCodes={invalid_shipping_address:"shippingContactInvalid",unserviceable_address:"addressUnserviceable",invalid_billing_address:"billingContactInvalid",invalid_coupon_code:"couponCodeInvalid",expired_coupon_code:"couponCodeExpired",invalid_payment_data:"unknown",unknown:"unknown"};var error=request.error;if(!error){return}return[new ApplePayError(error.code?errorCodes[error.code]:"unknown",error.contactField,error.message?error.message:"")]};exports.buildErrors=buildErrors;var buildWalletNonceError=function buildWalletNonceError(error){return[new ApplePayError("unknown",undefined,(error===null||error===void 0?void 0:error.developerMessage)||(error===null||error===void 0?void 0:error.message)||"")]};exports.buildWalletNonceError=buildWalletNonceError;var buildPaymentRequest=function buildPaymentRequest(request){var _a;var requiredShippingContactFields=[];if(request.requireShippingAddress){requiredShippingContactFields.push("name");requiredShippingContactFields.push("postalAddress")}if(request.requireEmail){requiredShippingContactFields.push("email")}if(request.requirePhone){requiredShippingContactFields.push("phone")}return{countryCode:request.country,currencyCode:request.currency,merchantCapabilities:constants_1.APPLEPAY_MERCHANT_CAPABILITIES,supportedNetworks:constants_1.APPLEPAY_SUPPORTED_NETWORKS,total:(0,exports.buildTotal)(request),lineItems:(0,exports.buildLineItems)(request),requiredBillingContactFields:["name","postalAddress"],requiredShippingContactFields:requiredShippingContactFields.length?requiredShippingContactFields:undefined,supportsCouponCode:request.supportCouponCode,couponCode:request.supportCouponCode?(_a=request.couponCode)===null||_a===void 0?void 0:_a.code:undefined}};exports.buildPaymentRequest=buildPaymentRequest;var buildMaskedPaymentRequest=function buildMaskedPaymentRequest(request){try{var masked="**masked**";var requestCopy=structuredClone(request);if(requestCopy.total){requestCopy.total=masked}if(requestCopy.lineItems){requestCopy.lineItems=masked}if(requestCopy.couponCode){requestCopy.couponCode=masked}return requestCopy}catch(error){console.warn(error);return{}}};exports.buildMaskedPaymentRequest=buildMaskedPaymentRequest},{"../constants":67}],69:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(h).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)})}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});exports.getCardAgreement=void 0;var dompurify_1=require("dompurify");var constants_1=require("../constants");var localization_1=require("./localization");var defaultStyles=__importStar(require("../assets/card-on-file/styles"));var templateFilenameByType=_defineProperty(_defineProperty(_defineProperty({},"DEFAULT","DEFAULT.html"),"CARD_ON_FILE","CARD_ON_FILE.hbs"),"INSTANT_PAYOUT","INSTANT_PAYOUT.hbs");var getTemplateType=function getTemplateType(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(options.templateType&&templateFilenameByType[options.templateType]){return options.templateType}if(options.businessName&&options.businessWebsite&&options.businessPhone){return"CARD_ON_FILE"}return"DEFAULT"};var getCardAgreementFilePath=function getCardAgreementFilePath(metadata){var filename=templateFilenameByType[metadata.templateType];if(!filename){throw new Error("Unknown template type: ".concat(metadata.templateType))}return"https://d1oxd31ykxugjs.cloudfront.net".concat("/",metadata.lang,"/").concat(metadata.countryCode,"/").concat(filename)};var createElement=function createElement(elementName,defaultStyles,customStyles){var element=document.createElement(elementName);if(defaultStyles){Object.keys(defaultStyles).forEach(function(property){element.style.setProperty(property,defaultStyles[property])})}if(customStyles){Object.keys(customStyles).forEach(function(property){element.style.setProperty(property,customStyles[property])})}return element};var compileCardAgreementTemplate=function compileCardAgreementTemplate(template,metadata,customStyles){var agreement=template.replace(new RegExp("\n","g")," ").replace(new RegExp("<.*?>","g"),"");if(metadata.templateType==="INSTANT_PAYOUT"){var businessWebsiteElement=createElement("a",defaultStyles.businessWebsiteLink,customStyles.businessWebsiteLink);var businessPhoneElement=createElement("span",defaultStyles.businessPhoneText,customStyles.businessPhoneText);businessWebsiteElement.textContent=constants_1.GODADDY_CONTACT_LINK;businessPhoneElement.textContent=constants_1.GODADDY_CONTACT_PHONE;businessWebsiteElement.setAttribute("href",constants_1.GODADDY_CONTACT_LINK);businessWebsiteElement.setAttribute("target","_blank");businessWebsiteElement.setAttribute("rel","noopener noreferrer");return agreement.replace(new RegExp("{{business_website}}","g"),businessWebsiteElement.outerHTML).replace(new RegExp("{{business_contact_phone}}","g"),businessPhoneElement.outerHTML)}if(metadata.templateType==="CARD_ON_FILE"){var businessNameElement=createElement("span",defaultStyles.businessNameText,customStyles.businessNameText);var _businessWebsiteElement=createElement("a",defaultStyles.businessWebsiteLink,customStyles.businessWebsiteLink);var _businessPhoneElement=createElement("span",defaultStyles.businessPhoneText,customStyles.businessPhoneText);businessNameElement.textContent=metadata.businessName||"";_businessWebsiteElement.textContent=metadata.businessWebsite||"";_businessPhoneElement.textContent=metadata.businessPhone||"";_businessWebsiteElement.setAttribute("href",metadata.businessWebsite||"");_businessWebsiteElement.setAttribute("target","_blank");_businessWebsiteElement.setAttribute("rel","noopener noreferrer");return agreement.replace(new RegExp("{{business_name}}","g"),businessNameElement.outerHTML).replace(new RegExp("{{business_website}}","g"),_businessWebsiteElement.outerHTML).replace(new RegExp("{{business_contact_phone}}","g"),_businessPhoneElement.outerHTML)}return agreement};var genereteCardAgreementHtml=function genereteCardAgreementHtml(agreement,metadata,locale,customStyles,hideActionButtons,onAcceptClick,onDeclineClick){var globalContainer=createElement("div",defaultStyles.globalContainer,customStyles.globalContainer);var agreementContainer=createElement("div",defaultStyles.agreementContainer,customStyles.agreementContainer);var title=createElement("h1",defaultStyles.title,customStyles.title);var closeIconContainer=createElement("div",defaultStyles.closeIconContainer,customStyles.closeIconContainer);var closeIcon=createElement("span",defaultStyles.closeIcon,customStyles.closeIcon);var mainText=createElement("p",defaultStyles.mainText,customStyles.mainText);var actionButtonsContainer=createElement("div",defaultStyles.actionButtonsContainer,customStyles.actionButtonsContainer);var acceptButton=createElement("button",defaultStyles.acceptButton,customStyles.acceptButton);var declineButton=createElement("button",defaultStyles.declineButton,customStyles.declineButton);var messages=(0,localization_1.getMessages)(locale);mainText.innerHTML=(0,dompurify_1.sanitize)(agreement,{ALLOWED_TAGS:["span","a"],ALLOWED_ATTR:["style","href","target","rel"]});closeIcon.innerHTML="&#215;";if(metadata.templateType==="INSTANT_PAYOUT"){title.textContent=messages["cardOnFile.authorization"]}else{title.textContent=messages["cardOnFile.termsAndConditions"]}acceptButton.textContent=messages["cardOnFile.accept"];declineButton.textContent=messages["cardOnFile.decline"];closeIconContainer.appendChild(closeIcon);actionButtonsContainer.appendChild(declineButton);actionButtonsContainer.appendChild(acceptButton);agreementContainer.appendChild(closeIconContainer);agreementContainer.appendChild(title);agreementContainer.appendChild(mainText);if(!hideActionButtons){agreementContainer.appendChild(actionButtonsContainer)}globalContainer.appendChild(agreementContainer);globalContainer.onclick=function(event){var isClickInside=agreementContainer.contains(event.target);if(!isClickInside&&document.body.contains(globalContainer)){document.body.removeChild(globalContainer)}};closeIcon.onclick=function(){if(document.body.contains(globalContainer)){document.body.removeChild(globalContainer)}};if(onAcceptClick){acceptButton.onclick=onAcceptClick}if(onDeclineClick){declineButton.onclick=onDeclineClick}return globalContainer};var requestTemplate=function requestTemplate(metadata){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark(function _callee(){var response,lang,countryCode,template;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(getCardAgreementFilePath(metadata));case 3:response=_context.sent;if(response.ok){_context.next=9;break}lang=metadata.lang,countryCode=metadata.countryCode;console.warn('Unable to fetch template for language "'.concat(lang,'" and countryCode "').concat(countryCode,'"'));_context.next=13;break;case 9:_context.next=11;return response.text();case 11:template=_context.sent;return _context.abrupt("return",{template:template,metadata:metadata});case 13:_context.next=18;break;case 15:_context.prev=15;_context.t0=_context["catch"](0);console.error(_context.t0);case 18:return _context.abrupt("return",null);case 19:case"end":return _context.stop()}},_callee,null,[[0,15]])}))};var findTemplate=function findTemplate(metadata){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark(function _callee2(){var localizedTemplate,defaultMetadata,defaultTemplate;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return requestTemplate(metadata);case 2:localizedTemplate=_context2.sent;if(!localizedTemplate){_context2.next=5;break}return _context2.abrupt("return",localizedTemplate);case 5:defaultMetadata=_extends(_extends({},metadata),{lang:constants_1.COF_DEFAULT_LANGUAGE,countryCode:constants_1.COF_DEFAULT_COUNTRY_CODE});_context2.next=8;return requestTemplate(defaultMetadata);case 8:defaultTemplate=_context2.sent;if(!defaultTemplate){_context2.next=11;break}return _context2.abrupt("return",defaultTemplate);case 11:return _context2.abrupt("return",null);case 12:case"end":return _context2.stop()}},_callee2)}))};var getCardAgreement=function getCardAgreement(locale,hideActionButtons,options,onAcceptClick,onDeclineClick){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark(function _callee3(){var intialMetadata,templateResponse,template,metadata,customStyles,agreement,container;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:intialMetadata={lang:(locale===null||locale===void 0?void 0:locale.length)===5?locale.slice(0,2).toUpperCase():constants_1.COF_DEFAULT_LANGUAGE,countryCode:(locale===null||locale===void 0?void 0:locale.length)===5?locale.slice(-2).toUpperCase():constants_1.COF_DEFAULT_COUNTRY_CODE,templateType:getTemplateType(options),businessName:options===null||options===void 0?void 0:options.businessName,businessWebsite:options===null||options===void 0?void 0:options.businessWebsite,businessPhone:options===null||options===void 0?void 0:options.businessPhone};_context3.next=3;return findTemplate(intialMetadata);case 3:templateResponse=_context3.sent;if(templateResponse){_context3.next=6;break}throw new Error("Card agreement template not found");case 6:template=templateResponse.template,metadata=templateResponse.metadata;customStyles=(options===null||options===void 0?void 0:options.style)||{};agreement=compileCardAgreementTemplate(template,metadata,customStyles);container=genereteCardAgreementHtml(agreement,metadata,locale||constants_1.DEFAULT_LOCALE,customStyles,hideActionButtons,onAcceptClick,onDeclineClick);return _context3.abrupt("return",{container:container,metadata:metadata});case 11:case"end":return _context3.stop()}},_callee3)}))};exports.getCardAgreement=getCardAgreement},{"../assets/card-on-file/styles":66,"../constants":67,"./localization":72,dompurify:8}],70:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();Object.defineProperty(exports,"__esModule",{value:true});exports.getSourceAppHostname=exports.createDefaultWalletRequest=exports.setButtonsContainerProperties=exports.setButtonProperties=exports.createIFrame=exports.getAllOptions=exports.shouldEnableCardOnFile=exports.isPaymentFormEnabled=exports.parseMessage=exports.loadScript=exports.removeCachedScripts=exports.getCachedScripts=void 0;var qs_1=require("qs");var localization_1=require("./localization");var constants=__importStar(require("../constants"));var cachedScripts={};var getCachedScripts=function getCachedScripts(){return _extends({},cachedScripts)};exports.getCachedScripts=getCachedScripts;var removeCachedScripts=function removeCachedScripts(){Object.keys(cachedScripts).forEach(function(key){return cachedScripts[key]=null})};exports.removeCachedScripts=removeCachedScripts;var loadScript=function loadScript(src){var existing=cachedScripts[src];if(existing){return existing}var promise=new Promise(function(resolve,reject){var script=document.createElement("script");script.src=src;script.async=true;var onScriptLoad=function onScriptLoad(){resolve()};var _onScriptError=function onScriptError(){script.removeEventListener("load",onScriptLoad);script.removeEventListener("error",_onScriptError);cachedScripts[src]=null;script.remove();reject(new Error("Unable to load script ".concat(src)))};script.addEventListener("load",onScriptLoad);script.addEventListener("error",_onScriptError);document.body.appendChild(script)});cachedScripts[src]=promise;return promise};exports.loadScript=loadScript;var parseMessage=function parseMessage(event){try{return JSON.parse(event.data)}catch(error){console.error(error)}return null};exports.parseMessage=parseMessage;var isPaymentFormEnabled=function isPaymentFormEnabled(options){var _a;return!((_a=options.paymentMethods)===null||_a===void 0?void 0:_a.length)||options.paymentMethods.includes("card")||options.paymentMethods.includes("ach")};exports.isPaymentFormEnabled=isPaymentFormEnabled;var shouldEnableCardOnFile=function shouldEnableCardOnFile(options){if(!(0,exports.isPaymentFormEnabled)(options)){return false}return!!options.enableCardOnFile};exports.shouldEnableCardOnFile=shouldEnableCardOnFile;var getAllOptions=function getAllOptions(businessId,applicationId,sessionId,mountOptions){return _extends(_extends({},mountOptions),{businessId:businessId,applicationId:applicationId,sessionId:sessionId,locale:(0,localization_1.getLocale)(mountOptions===null||mountOptions===void 0?void 0:mountOptions.locale),enableReCaptcha:!!(mountOptions===null||mountOptions===void 0?void 0:mountOptions.enableReCaptcha),enableCardOnFile:(0,exports.shouldEnableCardOnFile)(mountOptions||{})})};exports.getAllOptions=getAllOptions;var createIFrame=function createIFrame(options){var iFrame=document.createElement("iframe");iFrame.setAttribute("name",constants.IFRAME_NAME);iFrame.setAttribute("id",constants.IFRAME_NAME);var iFrameUrl="https://cdn.poynt.net/collect/index.html".concat("?",(0,qs_1.stringify)(options),"&parentOrigin=").concat(document.location.origin);if(options.iFrame){iFrame.style.cssText=JSON.stringify(options.iFrame);if(options.iFrame.height){iFrame.style["height"]=options.iFrame.height}if(options.iFrame.width){iFrame.style["width"]=options.iFrame.width}if(options.iFrame.border){iFrame.style["border"]=options.iFrame.border}if(options.iFrame.borderRadius){iFrame.style["borderRadius"]=options.iFrame.borderRadius}if(options.iFrame.boxShadow){iFrame.style["boxShadow"]=options.iFrame.boxShadow}}if(!(0,exports.isPaymentFormEnabled)(options)){iFrame.setAttribute("style","display: none")}iFrame.setAttribute("src",iFrameUrl);return iFrame};exports.createIFrame=createIFrame;var setButtonProperties=function setButtonProperties(container,buttonOptions){var button=container.getElementsByTagName("button")[0];var minWidth=(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.type)==="plain"?"160px":"240px";var minHeight="40px";var margin="8px";button.style.setProperty("width","100%");button.style.setProperty("height","100%");button.style.setProperty("min-height",minHeight);button.style.setProperty("min-width",minWidth);button.style.setProperty("border","unset");button.style.setProperty("outline-offset","0");button.style.setProperty("outline",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.border)||"revert");button.style.setProperty("border-radius",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.borderRadius)||"5px");container.style.setProperty("min-width",minWidth);container.style.setProperty("min-height",minHeight);container.style.setProperty("margin",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.margin)||margin);container.style.setProperty("width",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.width)||minWidth);container.style.setProperty("height",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.height)||minHeight);return container};exports.setButtonProperties=setButtonProperties;var setButtonsContainerProperties=function setButtonsContainerProperties(container,buttonsContainerOptions){container.style.setProperty("display","flex");container.style.setProperty("justify-content",(buttonsContainerOptions===null||buttonsContainerOptions===void 0?void 0:buttonsContainerOptions.justifyContent)||"center");container.style.setProperty("align-items",(buttonsContainerOptions===null||buttonsContainerOptions===void 0?void 0:buttonsContainerOptions.alignItems)||"center");container.style.setProperty("flex-direction",(buttonsContainerOptions===null||buttonsContainerOptions===void 0?void 0:buttonsContainerOptions.flexDirection)||"row");if(buttonsContainerOptions===null||buttonsContainerOptions===void 0?void 0:buttonsContainerOptions.style){var cssRules=Object.entries(buttonsContainerOptions.style);cssRules.forEach(function(cssRule){container.style.setProperty(cssRule[0],cssRule[1])})}return container};exports.setButtonsContainerProperties=setButtonsContainerProperties;var createDefaultWalletRequest=function createDefaultWalletRequest(){return{currency:"USD",country:"US",merchantName:"",total:{label:"",amount:"0.00"}}};exports.createDefaultWalletRequest=createDefaultWalletRequest;var getSourceAppHostname=function getSourceAppHostname(){var url=new URL(document.location.href);var sourceAppHostname=url.searchParams.get("sourceAppHostname");if(sourceAppHostname){var sanitizedSourceAppHostname=sourceAppHostname.replace(/[^a-zA-Z0-9.-]/g,"");var hostnameRegex=/^(?:([a-z0-9-]+\.)+)?([a-z0-9-]{1,61})\.([a-z0-9]{2,7})$/i;if(!hostnameRegex.test(sanitizedSourceAppHostname)){console.warn("Invalid sourceAppHostname provided. Ignoring.");return document.location.hostname}return sanitizedSourceAppHostname}return document.location.hostname};exports.getSourceAppHostname=getSourceAppHostname},{"../constants":67,"./localization":72,qs:40}],71:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}Object.defineProperty(exports,"__esModule",{value:true});exports.buildMaskedPaymentRequest=exports.buildPaymentRequest=exports.buildPaymentDataChangedHandlerError=exports.buildWalletNonceError=exports.buildMissedHandlerError=exports.buildDuplicateCouponCodeError=exports.buildError=exports.buildOfferInfo=exports.buildShippingMethods=exports.buildTransactionInfo=exports.buildLineItems=exports.getCardPaymentMethod=exports.getBaseCardPaymentMethod=void 0;var constants_1=require("../constants");var getBaseCardPaymentMethod=function getBaseCardPaymentMethod(request){var result={type:"CARD",parameters:{allowedAuthMethods:constants_1.GOOGLEPAY_ALLOWED_AUTHN_METHODS,allowedCardNetworks:constants_1.GOOGLEPAY_ALLOWED_CARD_NETWORKS}};result.parameters.billingAddressRequired=true;result.parameters.billingAddressParameters={format:"FULL"};if(request.requirePhone){result.parameters.billingAddressParameters.phoneNumberRequired=true}return result};exports.getBaseCardPaymentMethod=getBaseCardPaymentMethod;var getCardPaymentMethod=function getCardPaymentMethod(request,businessId){var baseCardPaymentMethod=(0,exports.getBaseCardPaymentMethod)(request);return _extends({tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:constants_1.GOOGLEPAY_GATEWAY,gatewayMerchantId:businessId}}},baseCardPaymentMethod)};exports.getCardPaymentMethod=getCardPaymentMethod;var buildLineItems=function buildLineItems(request){if(!request.lineItems){return[]}return request.lineItems.map(function(lineItem){return{label:lineItem.label,price:lineItem.amount,type:"LINE_ITEM",status:lineItem.isPending?"PENDING":"FINAL"}})};exports.buildLineItems=buildLineItems;var buildTransactionInfo=function buildTransactionInfo(request){var items=(0,exports.buildLineItems)(request);if(!request.total){return{countryCode:request.country,currencyCode:request.currency||"",totalPrice:"0.00",totalPriceStatus:"ESTIMATED",displayItems:items}}return{countryCode:request.country,currencyCode:request.currency,totalPrice:request.total.amount,totalPriceLabel:request.total.label,totalPriceStatus:request.total.isPending?"ESTIMATED":"FINAL",displayItems:items}};exports.buildTransactionInfo=buildTransactionInfo;var buildShippingMethods=function buildShippingMethods(request){var _a;if(!((_a=request.shippingMethods)===null||_a===void 0?void 0:_a.length)){return}var options=request.shippingMethods.map(function(shippingMethod){return{id:shippingMethod.id,label:shippingMethod.label,description:shippingMethod.detail}});return{shippingOptions:options}};exports.buildShippingMethods=buildShippingMethods;var buildOfferInfo=function buildOfferInfo(request){var _a;if(!((_a=request.couponCode)===null||_a===void 0?void 0:_a.code)){return{offers:[]}}return{offers:[{redemptionCode:request.couponCode.code,description:request.couponCode.label}]}};exports.buildOfferInfo=buildOfferInfo;var buildError=function buildError(request,callbackIntent){var errorCodes={invalid_shipping_address:"SHIPPING_ADDRESS_INVALID",unserviceable_address:"SHIPPING_ADDRESS_UNSERVICEABLE",invalid_billing_address:"PAYMENT_DATA_INVALID",invalid_coupon_code:"OFFER_INVALID",expired_coupon_code:"OFFER_INVALID",invalid_payment_data:"PAYMENT_DATA_INVALID",unknown:"OTHER_ERROR"};var error=request.error;if(!error){return}return{reason:error.code?errorCodes[error.code]:errorCodes.unknown,intent:callbackIntent,message:error.message||""}};exports.buildError=buildError;var buildDuplicateCouponCodeError=function buildDuplicateCouponCodeError(callbackIntent){return{reason:"OFFER_INVALID",intent:callbackIntent,message:"Coupon code already applied"}};exports.buildDuplicateCouponCodeError=buildDuplicateCouponCodeError;var buildMissedHandlerError=function buildMissedHandlerError(eventType,callbackIntent){return{reason:"OTHER_ERROR",intent:callbackIntent,message:"".concat(eventType," callback handler not found")}};exports.buildMissedHandlerError=buildMissedHandlerError;var buildWalletNonceError=function buildWalletNonceError(callbackIntent,error){return{reason:"OTHER_ERROR",intent:callbackIntent,message:(error===null||error===void 0?void 0:error.developerMessage)||(error===null||error===void 0?void 0:error.message)||""}};exports.buildWalletNonceError=buildWalletNonceError;var buildPaymentDataChangedHandlerError=function buildPaymentDataChangedHandlerError(callbackTrigger){return{reason:"OTHER_ERROR",intent:constants_1.GOOGLE_PAY_INTENT_MAP[callbackTrigger],message:'Callback trigger "'.concat(callbackTrigger,'" not found or intermediate payment data does not exist')}};exports.buildPaymentDataChangedHandlerError=buildPaymentDataChangedHandlerError;var buildPaymentRequest=function buildPaymentRequest(request,businessId,authJwt){var _a,_b;var merchantInfo={merchantId:constants_1.GOOGLEPAY_MERCHANT_ID,merchantOrigin:document.location.hostname,merchantName:request.merchantName,authJwt:authJwt};var result={apiVersion:constants_1.GOOGLEPAY_VERSION,apiVersionMinor:constants_1.GOOGLEPAY_VERSION_MINOR,merchantInfo:merchantInfo,allowedPaymentMethods:[(0,exports.getCardPaymentMethod)(request,businessId)],transactionInfo:(0,exports.buildTransactionInfo)(request)};var callbackIntents=["PAYMENT_AUTHORIZATION"];if(request.requireShippingAddress){callbackIntents.push("SHIPPING_ADDRESS");result.shippingAddressRequired=true;if(typeof request.requireShippingMethods==="undefined"||request.requireShippingMethods){result.shippingOptionRequired=true;callbackIntents.push("SHIPPING_OPTION")}result.shippingAddressParameters={allowedCountryCodes:constants_1.WALLET_SHIPPING_COUNTRY_CODES,phoneNumberRequired:request.requirePhone};if((_a=request.shippingMethods)===null||_a===void 0?void 0:_a.length){result.shippingOptionParameters=(0,exports.buildShippingMethods)(request)}}if(request.supportCouponCode){callbackIntents.push("OFFER");if((_b=request.couponCode)===null||_b===void 0?void 0:_b.code){result.offerInfo={offers:[{redemptionCode:request.couponCode.code,description:request.couponCode.label}]}}}if(request.requireEmail){result.emailRequired=true}result.callbackIntents=callbackIntents;return result};exports.buildPaymentRequest=buildPaymentRequest;var buildMaskedPaymentRequest=function buildMaskedPaymentRequest(request){try{var masked="**masked**";var requestCopy=structuredClone(request);if(requestCopy.merchantInfo){requestCopy.merchantInfo=masked}if(requestCopy.transactionInfo){requestCopy.transactionInfo=masked}if(requestCopy.shippingOptionParameters){requestCopy.shippingOptionParameters=masked}if(requestCopy.offerInfo){requestCopy.offerInfo=masked}return requestCopy}catch(error){console.warn(error);return{}}};exports.buildMaskedPaymentRequest=buildMaskedPaymentRequest},{"../constants":67}],72:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.getMessages=exports.getLocale=void 0;var constants_1=require("../constants");var snippet_json_1=__importDefault(require("l10n/collect/en-us/snippet.json"));var snippet_json_2=__importDefault(require("l10n/collect/en-ca/snippet.json"));var snippet_json_3=__importDefault(require("l10n/collect/fr-ca/snippet.json"));var snippet_json_4=__importDefault(require("l10n/collect/fr-fr/snippet.json"));var snippet_json_5=__importDefault(require("l10n/collect/it-IT/snippet.json"));var supportedLocalesMap=new Map([["en","en-US"],["en-us","en-US"],["en-US","en-US"],["en-ca","en-CA"],["en-CA","en-CA"],["fr","fr-FR"],["fr-ca","fr-CA"],["fr-CA","fr-CA"],["fr-fr","fr-FR"],["fr-FR","fr-FR"],["it","it-IT"],["it-it","it-IT"],["it-IT","it-IT"]]);var messages={"en-US":snippet_json_1["default"],"en-CA":snippet_json_2["default"],"fr-CA":snippet_json_3["default"],"fr-FR":snippet_json_4["default"],"it-IT":snippet_json_5["default"]};var getLocale=function getLocale(locale){if(locale&&supportedLocalesMap.has(locale)){return supportedLocalesMap.get(locale)}var cookieMarket=document.cookie.split(";").find(function(cookie){return cookie.includes("market=")})||"";var cookieLocale=cookieMarket.split("=")[1]||"";if(cookieLocale&&supportedLocalesMap.has(cookieLocale)){return supportedLocalesMap.get(cookieLocale)}if(window.navigator.language&&supportedLocalesMap.has(window.navigator.language)){return supportedLocalesMap.get(window.navigator.language)}return constants_1.DEFAULT_LOCALE};exports.getLocale=getLocale;var getMessages=function getMessages(locale){return messages[locale]?_extends(_extends({},messages[constants_1.DEFAULT_LOCALE]),messages[locale]):messages[constants_1.DEFAULT_LOCALE]};exports.getMessages=getMessages},{"../constants":67,"l10n/collect/en-ca/snippet.json":28,"l10n/collect/en-us/snippet.json":29,"l10n/collect/fr-ca/snippet.json":30,"l10n/collect/fr-fr/snippet.json":31,"l10n/collect/it-IT/snippet.json":32}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildMaskedCompleteRequest=exports.buildMaskedCheckoutRequest=exports.buildPaymentAuthorizedResponse=exports.buildAddress=exports.buildWalletNonceRequest=exports.buildCompleteRequest=exports.buildCheckoutRequest=exports.formatAmountWithCents=exports.getOrderQuantity=exports.getPazeScriptUrl=void 0;var constants_1=require("../constants");var getPazeScriptUrl=function getPazeScriptUrl(){return"https://checkout.paze.com/web/resources/js/digitalwallet-sdk.js".concat("?id=","46VM0VIBJ63520UZ7X6U14L-0rahMJIVUiE1MgKLDdBgyTXkE")};exports.getPazeScriptUrl=getPazeScriptUrl;var getOrderQuantity=function getOrderQuantity(lineItems){if(!(lineItems===null||lineItems===void 0?void 0:lineItems.length)){return}return lineItems.length.toString()};exports.getOrderQuantity=getOrderQuantity;var formatAmountWithCents=function formatAmountWithCents(amount){if(!amount||!Number(amount)){return"0.00"}var parts=amount.split(".");if(parts.length===1){return"".concat(parts[0],".00")}if(parts.length===2&&parts[1].length===1){return"".concat(parts[0],".").concat(parts[1],"0")}return amount};exports.formatAmountWithCents=formatAmountWithCents;var buildCheckoutRequest=function buildCheckoutRequest(request,sessionId,emailAddress){return{intent:"EXPRESS_CHECKOUT",emailAddress:emailAddress,sessionId:sessionId,actionCode:"START_FLOW",transactionValue:{transactionCurrencyCode:request.currency,transactionAmount:(0,exports.formatAmountWithCents)(request.total.amount)},enhancedTransactionData:{orderQuantity:(0,exports.getOrderQuantity)(request.lineItems)},shippingPreference:"NONE",billingPreference:"ALL",acceptedShippingCountries:constants_1.WALLET_SHIPPING_COUNTRY_CODES,acceptedPaymentCardNetworks:constants_1.PAZE_ALLOWED_CARD_NETWORKS}};exports.buildCheckoutRequest=buildCheckoutRequest;var buildCompleteRequest=function buildCompleteRequest(request,sessionId){return{sessionId:sessionId,transactionType:"PURCHASE",transactionValue:{transactionCurrencyCode:request.currency,transactionAmount:(0,exports.formatAmountWithCents)(request.total.amount)},transactionOptions:{billingPreference:"ALL",payloadTypeIndicator:"PAYMENT"},enhancedTransactionData:{orderQuantity:(0,exports.getOrderQuantity)(request.lineItems)}}};exports.buildCompleteRequest=buildCompleteRequest;var buildWalletNonceRequest=function buildWalletNonceRequest(checkout,complete,requestId){var result={pazePaymentToken:{paymentTokenJwt:complete.completeResponse}};var billingAddress=checkout.maskedCard.billingAddress;var customerInfo=checkout.consumer;if(billingAddress){result.zip=billingAddress.zip;result.line1=billingAddress.line1;result.line2=billingAddress.line2;result.city=billingAddress.city;result.territory=billingAddress.state;result.countryCode=billingAddress.countryCode}if(customerInfo){result.firstName=customerInfo.firstName;result.lastName=customerInfo.lastName}if(requestId){result.requestId=requestId}return result};exports.buildWalletNonceRequest=buildWalletNonceRequest;var buildAddress=function buildAddress(address,customerInfo){var result={administrativeArea:address.state,countryCode:address.countryCode,postalCode:address.zip,locality:address.city,addressLines:[address.line1||"",address.line2||"",address.line3||""].filter(function(address){return address})};if(customerInfo){result.emailAddress=customerInfo.emailAddress;var phoneNumber;var name=customerInfo.fullName||"".concat(customerInfo.firstName," ").concat(customerInfo.lastName).trim();if(customerInfo.mobileNumber){phoneNumber="".concat(customerInfo.mobileNumber.countryCode).concat(customerInfo.mobileNumber.phoneNumber).trim()}if("deliveryContactDetails"in address){result.name=address.deliveryContactDetails.contactFullName||name;result.phoneNumber=address.deliveryContactDetails.contactPhoneNumber||phoneNumber}else{result.name=name;result.phoneNumber=phoneNumber}}return result};exports.buildAddress=buildAddress;var buildPaymentAuthorizedResponse=function buildPaymentAuthorizedResponse(checkout,nonceResponse,requireShippingAddress){var result={nonce:nonceResponse.nonce,source:"paze"};var billingAddress=checkout.maskedCard.billingAddress;var shippingAddress=checkout.shippingAddress;var customerInfo=checkout.consumer;if(billingAddress){result.billingAddress=(0,exports.buildAddress)(billingAddress,customerInfo)}if(requireShippingAddress&&shippingAddress){result.shippingAddress=(0,exports.buildAddress)(shippingAddress,customerInfo)}return result};exports.buildPaymentAuthorizedResponse=buildPaymentAuthorizedResponse;var buildMaskedCheckoutRequest=function buildMaskedCheckoutRequest(request){try{var masked="**masked**";var requestCopy=structuredClone(request);if(requestCopy.emailAddress){requestCopy.emailAddress=masked}if(requestCopy.transactionValue){requestCopy.transactionValue=masked}return requestCopy}catch(error){console.warn(error);return{}}};exports.buildMaskedCheckoutRequest=buildMaskedCheckoutRequest;var buildMaskedCompleteRequest=function buildMaskedCompleteRequest(request){try{var masked="**masked**";var requestCopy=structuredClone(request);if(requestCopy.transactionValue){requestCopy.transactionValue=masked}return requestCopy}catch(error){console.warn(error);return{}}};exports.buildMaskedCompleteRequest=buildMaskedCompleteRequest},{"../constants":67}],74:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var __rest=void 0&&(void 0).__rest||function(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]]}return t};Object.defineProperty(exports,"__esModule",{value:true});exports.buildWalletNonceRequest=exports.buildPaymentAuthorizedResponse=exports.buildAddress=exports.buildCouponCodeResponse=exports.buildShippingMethodResponse=exports.buildShippingAddressResponse=void 0;var buildShippingAddressResponse=function buildShippingAddressResponse(event){return{shippingAddress:{administrativeArea:event.administrativeArea||"",countryCode:event.countryCode||"",postalCode:event.postalCode||"",locality:event.locality||""}}};exports.buildShippingAddressResponse=buildShippingAddressResponse;var buildShippingMethodResponse=function buildShippingMethodResponse(event,shippingMethods){var result={shippingMethod:{}};if("identifier"in event){result.shippingMethod={id:event.identifier,label:event.label,detail:event.detail,amount:event.amount}}if("id"in event){var shippingMethod=(shippingMethods||[]).find(function(item){return item.id===event.id});result.shippingMethod={id:event.id,label:shippingMethod===null||shippingMethod===void 0?void 0:shippingMethod.label,detail:shippingMethod===null||shippingMethod===void 0?void 0:shippingMethod.detail,amount:shippingMethod===null||shippingMethod===void 0?void 0:shippingMethod.amount}}return result};exports.buildShippingMethodResponse=buildShippingMethodResponse;var buildCouponCodeResponse=function buildCouponCodeResponse(event){return{couponCode:Array.isArray(event)?event[0]:event}};exports.buildCouponCodeResponse=buildCouponCodeResponse;var buildAddress=function buildAddress(address,email){var result={};if("givenName"in address){var phoneticFamilyName=address.phoneticFamilyName,phoneticGivenName=address.phoneticGivenName,subLocality=address.subLocality,subAdministrativeArea=address.subAdministrativeArea,country=address.country,_address$givenName=address.givenName,givenName=_address$givenName===void 0?"":_address$givenName,_address$familyName=address.familyName,familyName=_address$familyName===void 0?"":_address$familyName,data=__rest(address,["phoneticFamilyName","phoneticGivenName","subLocality","subAdministrativeArea","country","givenName","familyName"]);result=_extends(_extends({},data),{name:"".concat(givenName," ").concat(familyName)})}if("name"in address){var sortingCode=address.sortingCode,_address$address=address.address1,address1=_address$address===void 0?"":_address$address,_address$address2=address.address2,address2=_address$address2===void 0?"":_address$address2,_address$address3=address.address3,address3=_address$address3===void 0?"":_address$address3,_data=__rest(address,["sortingCode","address1","address2","address3"]);result=_extends(_extends({},_data),{emailAddress:email,addressLines:[address1,address2,address3].filter(function(address){return address})})}return result};exports.buildAddress=buildAddress;var buildPaymentAuthorizedResponse=function buildPaymentAuthorizedResponse(event,nonceResponse,requireShippingAddress){var _a;var result={};if("token"in event){if(event.billingContact){result.billingAddress=(0,exports.buildAddress)(event.billingContact)}if(event.shippingContact){var shippingAddress=(0,exports.buildAddress)(event.shippingContact);if(requireShippingAddress){result.shippingAddress=shippingAddress}if(result.billingAddress){if(shippingAddress.emailAddress){result.billingAddress.emailAddress=shippingAddress.emailAddress}if(shippingAddress.phoneNumber){result.billingAddress.phoneNumber=shippingAddress.phoneNumber}}}result.source="apple_pay"}if("paymentMethodData"in event){if(event.shippingAddress){result.shippingAddress=(0,exports.buildAddress)(event.shippingAddress,event.email)}if((_a=event.paymentMethodData.info)===null||_a===void 0?void 0:_a.billingAddress){result.billingAddress=(0,exports.buildAddress)(event.paymentMethodData.info.billingAddress,event.email)}result.source="google_pay"}result.nonce=nonceResponse.nonce;return result};exports.buildPaymentAuthorizedResponse=buildPaymentAuthorizedResponse;var buildWalletNonceRequest=function buildWalletNonceRequest(event){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z;var result={};if("token"in event){result={applePayPaymentToken:event.token,zip:(_a=event.billingContact)===null||_a===void 0?void 0:_a.postalCode,line1:((_b=event.billingContact)===null||_b===void 0?void 0:_b.addressLines)&&((_c=event.billingContact)===null||_c===void 0?void 0:_c.addressLines[0]),line2:((_d=event.billingContact)===null||_d===void 0?void 0:_d.addressLines)&&((_e=event.billingContact)===null||_e===void 0?void 0:_e.addressLines[1]),city:(_f=event.billingContact)===null||_f===void 0?void 0:_f.locality,territory:(_g=event.billingContact)===null||_g===void 0?void 0:_g.administrativeArea,countryCode:(_h=event.billingContact)===null||_h===void 0?void 0:_h.countryCode,firstName:(_j=event.billingContact)===null||_j===void 0?void 0:_j.givenName,lastName:(_k=event.billingContact)===null||_k===void 0?void 0:_k.familyName}}if("paymentMethodData"in event){result={googlePayPaymentToken:event.paymentMethodData,zip:(_m=(_l=event.paymentMethodData.info)===null||_l===void 0?void 0:_l.billingAddress)===null||_m===void 0?void 0:_m.postalCode,line1:(_p=(_o=event.paymentMethodData.info)===null||_o===void 0?void 0:_o.billingAddress)===null||_p===void 0?void 0:_p.address1,line2:(_r=(_q=event.paymentMethodData.info)===null||_q===void 0?void 0:_q.billingAddress)===null||_r===void 0?void 0:_r.address2,city:(_t=(_s=event.paymentMethodData.info)===null||_s===void 0?void 0:_s.billingAddress)===null||_t===void 0?void 0:_t.locality,territory:(_v=(_u=event.paymentMethodData.info)===null||_u===void 0?void 0:_u.billingAddress)===null||_v===void 0?void 0:_v.administrativeArea,countryCode:(_x=(_w=event.paymentMethodData.info)===null||_w===void 0?void 0:_w.billingAddress)===null||_x===void 0?void 0:_x.countryCode,firstName:(_z=(_y=event.paymentMethodData.info)===null||_y===void 0?void 0:_y.billingAddress)===null||_z===void 0?void 0:_z.name}}return result};exports.buildWalletNonceRequest=buildWalletNonceRequest},{}],75:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(h).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)})}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var constants=__importStar(require("../constants"));var walletHelpers=__importStar(require("../helpers/wallet"));var applePayHelpers=__importStar(require("../helpers/applepay"));var common_1=require("../helpers/common");var ApplePay=function(){function ApplePay(sharedService){_classCallCheck(this,ApplePay);this.sharedService=sharedService;this.initialized=false;this.applePaySession=null}return _createClass(ApplePay,[{key:"initialize",value:function initialize(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee(){var _a,walletRequest,applePaySession;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!this.initialized){_context.next=2;break}return _context.abrupt("return");case 2:_context.prev=2;walletRequest=this.sharedService.getWalletRequest();if(!((_a=walletRequest.disableWallets)===null||_a===void 0?void 0:_a.applePay)){_context.next=6;break}return _context.abrupt("return");case 6:if(!(window.ApplePaySession&&ApplePaySession.supportsVersion(constants.APPLEPAY_VERSION)&&ApplePaySession.canMakePayments())){_context.next=13;break}_context.next=9;return this.sharedService.walletApi.validateApplePay({domainName:(0,common_1.getSourceAppHostname)(),displayName:walletRequest.merchantName&&walletRequest.merchantName.substring(0,64)});case 9:applePaySession=_context.sent;if(!applePaySession){_context.next=13;break}this.initialized=true;return _context.abrupt("return");case 13:_context.next=18;break;case 15:_context.prev=15;_context.t0=_context["catch"](2);this.sharedService.handleError("APPLE_PAY",_context.t0);case 18:case"end":return _context.stop()}},_callee,this,[[2,15]])}))}},{key:"isReady",value:function isReady(){return this.initialized}},{key:"buildSession",value:function buildSession(){var paymentRequest=applePayHelpers.buildPaymentRequest(this.sharedService.getWalletRequest());this.applePaySession=new ApplePaySession(constants.APPLEPAY_VERSION,paymentRequest);return this.applePaySession}},{key:"startSession",value:function startSession(walletRequest){this.sharedService.updateWalletRequest(walletRequest||{},"init_wallet");this.handler()}},{key:"abortSession",value:function abortSession(){if(!this.applePaySession){return this.sharedService.handleError("APPLE_PAY",new Error("ApplePay session not found"))}try{this.applePaySession.abort();this.applePaySession=null}catch(error){this.sharedService.handleError("APPLE_PAY",error)}}},{key:"mount",value:function mount(buttonOptions,applePayButtonOptions){var _this=this;var _a;var options=_extends(_extends({},buttonOptions),applePayButtonOptions);var container=document.createElement("div");container.id="applepay-button-container";var button=document.createElement("button");var type=options.type;if(options.type==="checkout"){type="check-out"}button.setAttribute("type","button");var color=!options.color||options.color==="default"?"black":options.color;button.style.setProperty("-webkit-appearance","-apple-pay-button");button.style.setProperty("-apple-pay-button-type",type||"buy");button.style.setProperty("-apple-pay-button-style",color);button.style.setProperty("cursor","pointer");button.setAttribute("lang",options.locale||"en");button.onclick=function(){if(!(options===null||options===void 0?void 0:options.onClick)){return _this.startSession()}options.onClick({source:"apple_pay"})};container.appendChild(button);(0,common_1.setButtonProperties)(container,options);(_a=this.sharedService.buttonsContainer)===null||_a===void 0?void 0:_a.appendChild(container)}},{key:"handler",value:function handler(){var _this2=this;var domainName=(0,common_1.getSourceAppHostname)();if(constants.DOMAIN_BLACKLIST.includes(domainName)){return this.sharedService.handleError("WALLET",new Error(domainName+" is blacklisted. Please reach out GDP support."))}if(!window.ApplePaySession){return this.sharedService.handleError("APPLE_PAY",new Error("ApplePay session not found"))}this.sharedService.processCallbacks("wallet_button_click",{source:"apple_pay"});var session=this.buildSession();var walletRequest=this.sharedService.getWalletRequest();session.onvalidatemerchant=function(event){_this2.sharedService.walletApi.validateApplePay({domainName:domainName,validationUrl:event.validationURL,displayName:walletRequest.merchantName&&walletRequest.merchantName.substring(0,64)}).then(function(applePaySession){session.completeMerchantValidation(applePaySession)})["catch"](function(error){_this2.sharedService.handleError("APPLE_PAY",error)})};if(walletRequest.requireShippingAddress){if(this.sharedService.listenerCallbacks["shipping_address_change"]){session.onshippingcontactselected=function(event){var updateWith=function updateWith(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate,"shipping_address_change");session.completeShippingContactSelection({newTotal:applePayHelpers.buildTotal(walletRequest),newLineItems:applePayHelpers.buildLineItems(walletRequest),newShippingMethods:applePayHelpers.buildShippingMethods(walletRequest),errors:applePayHelpers.buildErrors(walletRequest)})};_this2.sharedService.processCallbacks("shipping_address_change",_extends(_extends({},walletHelpers.buildShippingAddressResponse(event.shippingContact)),{updateWith:updateWith}))}}if(this.sharedService.listenerCallbacks["shipping_method_change"]){session.onshippingmethodselected=function(event){var updateWith=function updateWith(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate,"shipping_method_change");session.completeShippingMethodSelection({newTotal:applePayHelpers.buildTotal(walletRequest),newLineItems:applePayHelpers.buildLineItems(walletRequest)})};_this2.sharedService.processCallbacks("shipping_method_change",_extends(_extends({},walletHelpers.buildShippingMethodResponse(event.shippingMethod,walletRequest.shippingMethods)),{updateWith:updateWith}))}}}if(this.sharedService.listenerCallbacks["payment_authorized"]){session.onpaymentauthorized=function(event){var complete=function complete(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate||{},"payment_authorized");var errors=applePayHelpers.buildErrors(walletRequest);var status=errors?ApplePaySession.STATUS_FAILURE:ApplePaySession.STATUS_SUCCESS;session.completePayment({status:status,errors:errors})};_this2.sharedService.walletApi.getWalletNonce(walletHelpers.buildWalletNonceRequest(event.payment)).then(function(nonceResponse){_this2.sharedService.processCallbacks("payment_authorized",_extends(_extends({},walletHelpers.buildPaymentAuthorizedResponse(event.payment,nonceResponse,walletRequest.requireShippingAddress)),{complete:complete}))})["catch"](function(error){_this2.sharedService.handleError("APPLE_PAY_NONCE",error);session.completePayment({status:ApplePaySession.STATUS_FAILURE,errors:applePayHelpers.buildWalletNonceError(error)})})}}if(this.sharedService.listenerCallbacks["close_wallet"]){session.oncancel=function(event){_this2.sharedService.processCallbacks("close_wallet",event)}}if(walletRequest.supportCouponCode&&this.sharedService.listenerCallbacks["coupon_code_change"]){session.oncouponcodechanged=function(event){var updateWith=function updateWith(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate,"coupon_code_change");session.completeCouponCodeChange({newTotal:applePayHelpers.buildTotal(walletRequest),newLineItems:applePayHelpers.buildLineItems(walletRequest),newShippingMethods:applePayHelpers.buildShippingMethods(walletRequest),errors:applePayHelpers.buildErrors(walletRequest)})};_this2.sharedService.processCallbacks("coupon_code_change",_extends(_extends({},walletHelpers.buildCouponCodeResponse(event.couponCode)),{updateWith:updateWith}))}}session.begin()}}])}();exports["default"]=ApplePay},{"../constants":67,"../helpers/applepay":68,"../helpers/common":70,"../helpers/wallet":74}],76:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(h).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)})}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var card_on_file_1=require("../helpers/card-on-file");var CardOnFile=function(){function CardOnFile(sharedService){_classCallCheck(this,CardOnFile);this.sharedService=sharedService;this.cardAgreementData=null}return _createClass(CardOnFile,[{key:"mount",value:function mount(locale,hideActionButtons,options){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee(){var _this=this;var actionHandler,agreement;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;actionHandler=function actionHandler(value){return function(){var _a;_this.sharedService.postIFrameMessage({type:"card_on_file_set_flag",options:{value:value}});var container=(_a=_this.cardAgreementData)===null||_a===void 0?void 0:_a.container;if(container&&document.body.contains(container)){document.body.removeChild(container)}}};_context.next=4;return(0,card_on_file_1.getCardAgreement)(locale,hideActionButtons,options,actionHandler(true),actionHandler(false));case 4:agreement=_context.sent;this.cardAgreementData=agreement;this.sharedService.on("card_on_file_show_agreement",function(){var _a;if((_a=_this.cardAgreementData)===null||_a===void 0?void 0:_a.container){document.body.appendChild(_this.cardAgreementData.container)}});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](0);this.sharedService.handleError("CARD_ON_FILE",_context.t0);case 12:;case 13:case"end":return _context.stop()}},_callee,this,[[0,9]])}))}},{key:"unmount",value:function unmount(){if(this.cardAgreementData){if(document.body.contains(this.cardAgreementData.container)){document.body.removeChild(this.cardAgreementData.container)}this.sharedService.off("card_on_file_show_agreement");this.cardAgreementData=null}}}])}();exports["default"]=CardOnFile},{"../helpers/card-on-file":69}],77:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(h).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)})}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var constants=__importStar(require("../constants"));var walletHelpers=__importStar(require("../helpers/wallet"));var googlePayHelpers=__importStar(require("../helpers/googlepay"));var common_1=require("../helpers/common");var GooglePay=function(){function GooglePay(sharedService){var _this=this;_classCallCheck(this,GooglePay);this.sharedService=sharedService;this.updateWithWrapper=function(callbackTrigger,resolve){var callbackIntent=constants.GOOGLE_PAY_INTENT_MAP[callbackTrigger];var eventType=constants.GOOGLE_PAY_EVENT_MAP[callbackTrigger];return function(walletRequestUpdate){_this.sharedService.updateWalletRequest(walletRequestUpdate,eventType);var walletRequest=_this.sharedService.getWalletRequest();var update={};var transactionInfo=googlePayHelpers.buildTransactionInfo(walletRequest);var error=googlePayHelpers.buildError(walletRequest,callbackIntent);if(transactionInfo){update.newTransactionInfo=transactionInfo}if(error){update.error=error}if(walletRequest.requireShippingAddress&&callbackTrigger!=="SHIPPING_OPTION"){update.newShippingOptionParameters=googlePayHelpers.buildShippingMethods(walletRequest)}if(callbackTrigger==="OFFER"){update.newOfferInfo=googlePayHelpers.buildOfferInfo(walletRequest)}resolve(update)}};this.completeWrapper=function(resolve){return function(walletRequestUpdate){_this.sharedService.updateWalletRequest(walletRequestUpdate||{},"payment_authorized");var walletRequest=_this.sharedService.getWalletRequest();var error=googlePayHelpers.buildError(walletRequest,"PAYMENT_AUTHORIZATION");resolve({transactionState:error?"ERROR":"SUCCESS",error:error})}};this.googlePayPaymentDataChangedHandler=function(intermediatePaymentData){return new Promise(function(resolve){var _a;var callbackTrigger=intermediatePaymentData.callbackTrigger;var callbackIntent=constants.GOOGLE_PAY_INTENT_MAP[callbackTrigger];var eventType=constants.GOOGLE_PAY_EVENT_MAP[callbackTrigger];var updateWith=_this.updateWithWrapper(callbackTrigger,resolve);var walletRequest=_this.sharedService.getWalletRequest();if(callbackTrigger==="INITIALIZE"&&!walletRequest.requireShippingAddress){return resolve({})}if(!_this.sharedService.listenerCallbacks[eventType]){return resolve({error:googlePayHelpers.buildMissedHandlerError(eventType,callbackIntent)})}if(callbackIntent==="SHIPPING_OPTION"&&intermediatePaymentData.shippingOptionData){return _this.sharedService.processCallbacks("shipping_method_change",_extends(_extends({},walletHelpers.buildShippingMethodResponse(intermediatePaymentData.shippingOptionData,walletRequest.shippingMethods)),{updateWith:updateWith}))}if(callbackIntent==="SHIPPING_ADDRESS"&&intermediatePaymentData.shippingAddress){return _this.sharedService.processCallbacks("shipping_address_change",_extends(_extends({},walletHelpers.buildShippingAddressResponse(intermediatePaymentData.shippingAddress)),{updateWith:updateWith}))}if(callbackIntent==="OFFER"&&((_a=intermediatePaymentData.offerData)===null||_a===void 0?void 0:_a.redemptionCodes)){if(intermediatePaymentData.offerData.redemptionCodes.length>1){return resolve({newOfferInfo:googlePayHelpers.buildOfferInfo(walletRequest),error:googlePayHelpers.buildDuplicateCouponCodeError(callbackIntent)})}return _this.sharedService.processCallbacks("coupon_code_change",_extends(_extends({},walletHelpers.buildCouponCodeResponse(intermediatePaymentData.offerData.redemptionCodes)),{updateWith:updateWith}))}var error=googlePayHelpers.buildPaymentDataChangedHandlerError(callbackTrigger);_this.sharedService.handleError("GOOGLE_PAY",error);resolve({error:error})})};this.googlePayPaymentAuthorizedHandler=function(paymentData){return new Promise(function(resolve){var complete=_this.completeWrapper(resolve);if(!_this.sharedService.listenerCallbacks["payment_authorized"]){return resolve({transactionState:"ERROR",error:googlePayHelpers.buildMissedHandlerError("payment_authorized","PAYMENT_AUTHORIZATION")})}_this.sharedService.walletApi.getWalletNonce(walletHelpers.buildWalletNonceRequest(paymentData)).then(function(nonceResponse){_this.sharedService.processCallbacks("payment_authorized",_extends(_extends({},walletHelpers.buildPaymentAuthorizedResponse(paymentData,nonceResponse)),{complete:complete}))})["catch"](function(error){_this.sharedService.handleError("GOOGLE_PAY_NONCE",error);resolve({transactionState:"ERROR",error:googlePayHelpers.buildWalletNonceError("PAYMENT_AUTHORIZATION",error)})})})};this.initialized=false;this.paymentsClient=null;this.googlePayValidationPayload=null}return _createClass(GooglePay,[{key:"initialize",value:function initialize(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee(){var _a,_b,_c,walletRequest,googlePayValidationPayload,paymentsClient,isReadyToPay;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!this.initialized){_context.next=2;break}return _context.abrupt("return");case 2:_context.prev=2;walletRequest=this.sharedService.getWalletRequest();if(!((_a=walletRequest.disableWallets)===null||_a===void 0?void 0:_a.googlePay)){_context.next=6;break}return _context.abrupt("return");case 6:_context.next=8;return(0,common_1.loadScript)(constants.GOOGLEPAY_SCRIPT_URL);case 8:if(!((_c=(_b=window.google)===null||_b===void 0?void 0:_b.payments)===null||_c===void 0?void 0:_c.api)){_context.next=22;break}_context.next=11;return this.sharedService.walletApi.validateGooglePay({domain:document.location.hostname});case 11:googlePayValidationPayload=_context.sent;if(!(googlePayValidationPayload.authJwt&&googlePayValidationPayload.googleEnvironment)){_context.next=22;break}paymentsClient=this.buildPaymentsClient(walletRequest,googlePayValidationPayload.googleEnvironment);_context.next=16;return paymentsClient.isReadyToPay({apiVersion:constants.GOOGLEPAY_VERSION,apiVersionMinor:constants.GOOGLEPAY_VERSION_MINOR,allowedPaymentMethods:[googlePayHelpers.getBaseCardPaymentMethod(walletRequest)],existingPaymentMethodRequired:false});case 16:isReadyToPay=_context.sent;if(!isReadyToPay.result){_context.next=22;break}this.initialized=true;this.paymentsClient=paymentsClient;this.googlePayValidationPayload=googlePayValidationPayload;return _context.abrupt("return");case 22:_context.next=27;break;case 24:_context.prev=24;_context.t0=_context["catch"](2);this.sharedService.handleError("GOOGLE_PAY",_context.t0);case 27:case"end":return _context.stop()}},_callee,this,[[2,24]])}))}},{key:"isReady",value:function isReady(){return this.initialized}},{key:"buildPaymentsClient",value:function buildPaymentsClient(walletRequest,googleEnvironment){var paymentDataCallbacks={onPaymentAuthorized:this.googlePayPaymentAuthorizedHandler};if(walletRequest.requireShippingAddress||walletRequest.supportCouponCode){paymentDataCallbacks.onPaymentDataChanged=this.googlePayPaymentDataChangedHandler}var paymentsClient=new window.google.payments.api.PaymentsClient({environment:googleEnvironment,merchantInfo:{merchantName:walletRequest.merchantName,merchantId:constants.GOOGLEPAY_MERCHANT_ID},paymentDataCallbacks:paymentDataCallbacks});return paymentsClient}},{key:"startSession",value:function startSession(walletRequest){this.sharedService.updateWalletRequest(walletRequest||{},"init_wallet");this.handler()}},{key:"mount",value:function mount(buttonOptions,googlePayButtonOptions){var _this2=this;var _a;var options=_extends(_extends({},buttonOptions),googlePayButtonOptions);try{if(this.paymentsClient){var container=this.paymentsClient.createButton({buttonColor:options===null||options===void 0?void 0:options.color,buttonType:options===null||options===void 0?void 0:options.type,buttonSizeMode:"fill",buttonLocale:options===null||options===void 0?void 0:options.locale,allowedPaymentMethods:[googlePayHelpers.getBaseCardPaymentMethod(this.sharedService.getWalletRequest())],onClick:function onClick(){if(!(options===null||options===void 0?void 0:options.onClick)){return _this2.startSession()}options.onClick({source:"google_pay"})}});container.id="googlepay-button-container";(0,common_1.setButtonProperties)(container,options);(_a=this.sharedService.buttonsContainer)===null||_a===void 0?void 0:_a.appendChild(container)}}catch(error){this.sharedService.handleError("GOOGLE_PAY",error)}}},{key:"handler",value:function handler(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee2(){var _a,domainName,paymentRequest,parsedError;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:domainName=document.location.hostname;if(!constants.DOMAIN_BLACKLIST.includes(domainName)){_context2.next=3;break}return _context2.abrupt("return",this.sharedService.handleError("WALLET",new Error(domainName+" is blacklisted. Please reach out GDP support.")));case 3:if(this.paymentsClient){_context2.next=5;break}return _context2.abrupt("return",this.sharedService.handleError("GOOGLE_PAY",new Error("GooglePay payments client not found")));case 5:if((_a=this.googlePayValidationPayload)===null||_a===void 0?void 0:_a.authJwt){_context2.next=7;break}return _context2.abrupt("return",this.sharedService.handleError("GOOGLE_PAY",new Error("GooglePay auth JWT token not found")));case 7:this.sharedService.processCallbacks("wallet_button_click",{source:"google_pay"});paymentRequest=googlePayHelpers.buildPaymentRequest(this.sharedService.getWalletRequest(),this.sharedService.businessId,this.googlePayValidationPayload.authJwt);_context2.prev=9;_context2.next=12;return this.paymentsClient.loadPaymentData(paymentRequest);case 12:_context2.next=19;break;case 14:_context2.prev=14;_context2.t0=_context2["catch"](9);parsedError=this.sharedService.parseError("GOOGLE_PAY",_context2.t0);this.sharedService.trackError(parsedError);this.sharedService.processCallbacks("close_wallet",{reason:parsedError.message});case 19:case"end":return _context2.stop()}},_callee2,this,[[9,14]])}))}}])}();exports["default"]=GooglePay},{"../constants":67,"../helpers/common":70,"../helpers/googlepay":71,"../helpers/wallet":74}],78:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(h).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)})}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});var uuid_1=require("uuid");var jwt_decode_1=__importDefault(require("jwt-decode"));var constants=__importStar(require("../constants"));var common_1=require("../helpers/common");var paze_1=require("../helpers/paze");var Paze=function(){function Paze(sharedService){_classCallCheck(this,Paze);this.sharedService=sharedService;this.initialized=false}return _createClass(Paze,[{key:"initialize",value:function initialize(emailAddress){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee(){var _a,walletRequest,options,canCheckout;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!this.initialized){_context.next=2;break}return _context.abrupt("return");case 2:_context.prev=2;walletRequest=this.sharedService.getWalletRequest();if(!((_a=walletRequest.disableWallets)===null||_a===void 0?void 0:_a.paze)){_context.next=6;break}return _context.abrupt("return");case 6:_context.next=8;return(0,common_1.loadScript)((0,paze_1.getPazeScriptUrl)());case 8:if(window.DIGITAL_WALLET_SDK){_context.next=10;break}throw new Error("Paze Wallet API is not available");case 10:options={client:{id:"46VM0VIBJ63520UZ7X6U14L-0rahMJIVUiE1MgKLDdBgyTXkE",name:walletRequest.merchantName,profileId:"GoDaddy"}};_context.next=13;return window.DIGITAL_WALLET_SDK.initialize(options);case 13:if(emailAddress){_context.next=17;break}this.emailAddress=undefined;this.initialized=true;return _context.abrupt("return");case 17:_context.next=19;return new Promise(function(resolve){return setTimeout(resolve,300)});case 19:_context.next=21;return window.DIGITAL_WALLET_SDK.canCheckout({emailAddress:emailAddress});case 21:canCheckout=_context.sent;if(canCheckout){_context.next=26;break}this.emailAddress=undefined;this.initialized=true;return _context.abrupt("return");case 26:if(!canCheckout.consumerPresent){_context.next=30;break}this.emailAddress=emailAddress;this.initialized=true;return _context.abrupt("return");case 30:_context.next=35;break;case 32:_context.prev=32;_context.t0=_context["catch"](2);this.sharedService.handleError("PAZE",_context.t0);case 35:case"end":return _context.stop()}},_callee,this,[[2,32]])}))}},{key:"isReady",value:function isReady(){return this.initialized}},{key:"startSession",value:function startSession(walletRequest){this.sharedService.updateWalletRequest(walletRequest||{},"init_wallet");this.handler()}},{key:"mount",value:function mount(buttonOptions,pazeButtonOptions){var _this=this;var _a;var options=_extends(_extends({},buttonOptions),pazeButtonOptions);var container=document.createElement("div");container.id="pazewallet-button-container";var button=document.createElement("button");button.setAttribute("type","button");if(options.color==="white"){button.style.setProperty("background-color","#FFFFFF");button.style.setProperty("background-image","url(".concat(constants.ASSETS_CDN_URL,"paze-logo-blue.svg)"))}else{button.style.setProperty("background-image","url(".concat(constants.ASSETS_CDN_URL,"paze-logo-white.svg)"));button.style.setProperty("background-color",options.color==="black"?"#151B33":"#0F42F8")}button.style.setProperty("background-position","center");button.style.setProperty("background-repeat","no-repeat");button.onclick=function(){if(!options.onClick){return _this.startSession()}options.onClick({source:"paze"})};container.appendChild(button);(0,common_1.setButtonProperties)(container,options);(_a=this.sharedService.buttonsContainer)===null||_a===void 0?void 0:_a.appendChild(container)}},{key:"handleError",value:function handleError(type,originalError){var parsedError=this.sharedService.parseError(type,originalError);this.sharedService.trackError(parsedError);this.sharedService.processCallbacks("close_wallet",{source:"paze",error:parsedError})}},{key:"handler",value:function handler(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee2(){var _this2=this;var domainName,pazeSessionId,walletRequest,checkoutRequest,checkoutResult,decodedCheckoutResult,completeRequest,completeResult,nonceResponse,complete;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:this.sharedService.processCallbacks("wallet_button_click",{source:"paze"});domainName=(0,common_1.getSourceAppHostname)();if(!constants.DOMAIN_BLACKLIST.includes(domainName)){_context2.next=4;break}return _context2.abrupt("return",this.handleError("WALLET",new Error(domainName+" is blacklisted. Please reach out GDP support.")));case 4:if(this.initialized){_context2.next=6;break}return _context2.abrupt("return",this.handleError("PAZE",new Error("Paze Wallet is not initialized")));case 6:_context2.prev=6;pazeSessionId=(0,uuid_1.v4)();walletRequest=this.sharedService.getWalletRequest();checkoutRequest=(0,paze_1.buildCheckoutRequest)(walletRequest,pazeSessionId,this.emailAddress);_context2.next=12;return window.DIGITAL_WALLET_SDK.checkout(checkoutRequest);case 12:checkoutResult=_context2.sent;if(!(checkoutResult.result!=="COMPLETE"||!checkoutResult.checkoutResponse)){_context2.next=15;break}return _context2.abrupt("return",this.sharedService.processCallbacks("close_wallet",{source:"paze"}));case 15:decodedCheckoutResult=(0,jwt_decode_1["default"])(checkoutResult.checkoutResponse);completeRequest=(0,paze_1.buildCompleteRequest)(walletRequest,pazeSessionId);_context2.next=19;return window.DIGITAL_WALLET_SDK.complete(completeRequest);case 19:completeResult=_context2.sent;_context2.prev=20;_context2.next=23;return this.sharedService.walletApi.getWalletNonce((0,paze_1.buildWalletNonceRequest)(decodedCheckoutResult,completeResult,pazeSessionId));case 23:nonceResponse=_context2.sent;complete=function complete(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate||{},"payment_authorized")};this.sharedService.processCallbacks("payment_authorized",_extends(_extends({},(0,paze_1.buildPaymentAuthorizedResponse)(decodedCheckoutResult,nonceResponse)),{complete:complete}));_context2.next=31;break;case 28:_context2.prev=28;_context2.t0=_context2["catch"](20);return _context2.abrupt("return",this.handleError("PAZE_NONCE",_context2.t0));case 31:_context2.next=36;break;case 33:_context2.prev=33;_context2.t1=_context2["catch"](6);return _context2.abrupt("return",this.handleError("PAZE",_context2.t1));case 36:case"end":return _context2.stop()}},_callee2,this,[[6,33],[20,28]])}))}}])}();exports["default"]=Paze},{"../constants":67,"../helpers/common":70,"../helpers/paze":73,"jwt-decode":27,uuid:48}],79:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});var uuid_1=require("uuid");var wallet_api_1=__importDefault(require("../services/wallet-api"));var helpers=__importStar(require("../helpers/common"));var Shared=function(){function Shared(businessId,applicationId){var _this=this;var walletRequest=arguments.length>2&&arguments[2]!==undefined?arguments[2]:helpers.createDefaultWalletRequest();_classCallCheck(this,Shared);this.createMessageChannel=function(){_this.messageChannel=new MessageChannel;_this.messageChannel.port1.onmessage=function(event){var message=helpers.parseMessage(event);if(!message){return}_this.processCallbacks(message.type,message)};_this.postIFrameMessage({type:"init"},_this.messageChannel.port2)};this.businessId=businessId;this.applicationId=applicationId;this.sessionId=(0,uuid_1.v4)();this.listenerCallbacks={};this.iFrame=null;this.messageChannel=null;this.buttonsContainer=null;this.walletRequest=walletRequest;this.walletApi=new wallet_api_1["default"](this.businessId,this.applicationId,this.sessionId)}return _createClass(Shared,[{key:"on",value:function on(eventName,callback){this.listenerCallbacks[eventName]=callback}},{key:"off",value:function off(eventName){this.listenerCallbacks[eventName]=null}},{key:"parseError",value:function parseError(type,originalError){var error=_typeof(originalError)==="object"&&originalError.statusMessage?{message:originalError.statusMessage,name:originalError.statusCode,type:type}:_typeof(originalError)==="object"&&originalError.reason?{message:originalError.reason,name:"Error",type:type}:originalError instanceof Error?{message:originalError.message,name:originalError.name,type:type}:typeof originalError==="string"?{message:originalError,type:type}:_extends(_extends({},originalError),{type:type});return error}},{key:"trackError",value:function trackError(error){console.error(error)}},{key:"handleError",value:function handleError(type,originalError){var error=this.parseError(type,originalError);this.trackError(error)}},{key:"postIFrameMessage",value:function postIFrameMessage(data,port){var _a,_b;var stringifiedData=JSON.stringify(data);(_b=(_a=this.iFrame)===null||_a===void 0?void 0:_a.contentWindow)===null||_b===void 0?void 0:_b.postMessage(stringifiedData,"https://cdn.poynt.net",port?[port]:undefined)}},{key:"getWalletRequest",value:function getWalletRequest(){return this.walletRequest}},{key:"updateWalletRequest",value:function updateWalletRequest(update,event){var _a;var request=this.walletRequest;request.error=update.error;if(event==="payment_authorized"){return}if(update.total){request.total=update.total}if(update.lineItems){request.lineItems=update.lineItems}if(event!=="shipping_method_change"&&((_a=update.shippingMethods)===null||_a===void 0?void 0:_a.length)){request.shippingMethods=update.shippingMethods}if((event==="init_wallet"||event==="coupon_code_change")&&update.couponCode){request.couponCode=update.couponCode}}},{key:"processCallbacks",value:function processCallbacks(eventType,data){var _a,_b;(_b=(_a=this.listenerCallbacks)[eventType])===null||_b===void 0?void 0:_b.call(_a,data)}},{key:"mountPaymentForm",value:function mountPaymentForm(domElement,document,options){var _this2=this;var container=document.getElementById(domElement);this.iFrame=helpers.createIFrame(options);this.iFrame.onload=function(){_this2.createMessageChannel()};container===null||container===void 0?void 0:container.appendChild(this.iFrame)}},{key:"mountButtonsContainer",value:function mountButtonsContainer(domElement,document,options){var _a;var container=document.getElementById(domElement);var buttonsContainer=document.createElement("div");buttonsContainer.setAttribute("id","wallet-buttons-container");buttonsContainer.setAttribute("class",((_a=options.buttonsContainerOptions)===null||_a===void 0?void 0:_a.className)||"");helpers.setButtonsContainerProperties(buttonsContainer,options.buttonsContainerOptions);container===null||container===void 0?void 0:container.appendChild(buttonsContainer);this.buttonsContainer=buttonsContainer}},{key:"unmount",value:function unmount(domElement,document){if(this.messageChannel){this.messageChannel.port1.close();this.messageChannel.port2.close();this.messageChannel=null}if(document&&domElement){var form=document.getElementById(domElement);if(this.iFrame){if(form===null||form===void 0?void 0:form.contains(this.iFrame)){form.removeChild(this.iFrame)}this.iFrame=null}if(this.buttonsContainer){if(form===null||form===void 0?void 0:form.contains(this.buttonsContainer)){form.removeChild(this.buttonsContainer)}this.buttonsContainer=null}}this.walletApi.unmount()}}])}();exports["default"]=Shared},{"../helpers/common":70,"../services/wallet-api":80,uuid:48}],80:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(h).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)})}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var constants_1=require("../constants");var common_1=require("../helpers/common");var WalletApi=function(){function WalletApi(businessId,applicationId,sessionId){_classCallCheck(this,WalletApi);this.loaded=false;this.loadingPromise=null;this.businessId=businessId;this.applicationId=applicationId;this.sessionId=sessionId;this.iFrame=null;this.messageChannel=null;this.originMessageChannel=null;this.iFrameMessageChannel=null}return _createClass(WalletApi,[{key:"isMounted",value:function isMounted(){return!!(this.loaded&&this.iFrame&&document.body.contains(this.iFrame))}},{key:"mount",value:function mount(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee(){var _this=this;var promise;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!this.loadingPromise){_context.next=2;break}return _context.abrupt("return",this.loadingPromise);case 2:console.log("[debug] Wallet API Mount - Mounting wallet API iFrame");promise=new Promise(function(resolve,reject){var allOptions=(0,common_1.getAllOptions)(_this.businessId,_this.applicationId,_this.sessionId,{paymentMethods:["apple_pay","google_pay","paze"]});_this.iFrame=(0,common_1.createIFrame)(allOptions);_this.messageChannel=new MessageChannel;_this.originMessageChannel=_this.messageChannel.port1;_this.iFrameMessageChannel=_this.messageChannel.port2;_this.originMessageChannel.start();_this.iFrameMessageChannel.start();var onComplete=function onComplete(){var _a;console.log("[debug] Wallet API Mount - iFrame mounted");_this.loadingPromise=null;clearTimeout(timeout);(_a=_this.originMessageChannel)===null||_a===void 0?void 0:_a.removeEventListener("message",eventListener)};var timeout=setTimeout(function(){console.log("[debug] Wallet API Mount - iFrame timeout");onComplete();_this.unmount();reject(new Error("Timeout mounting wallet API iFrame"))},constants_1.DEFAULT_TIMEOUT);var eventListener=function eventListener(event){var message=(0,common_1.parseMessage)(event);console.log("[debug] Wallet API Mount - Received message",message===null||message===void 0?void 0:message.type);if((message===null||message===void 0?void 0:message.type)==="iframe_ready"){onComplete();_this.loaded=true;resolve()}};_this.originMessageChannel.addEventListener("message",eventListener);_this.iFrame.onload=function(){var _a,_b,_c;console.log("[debug] Wallet API Mount - iFrame loaded");if(!_this.iFrameMessageChannel){return}console.log("[debug] Wallet API Mount - Sending init message",!!((_a=_this.iFrame)===null||_a===void 0?void 0:_a.contentWindow));(_c=(_b=_this.iFrame)===null||_b===void 0?void 0:_b.contentWindow)===null||_c===void 0?void 0:_c.postMessage(JSON.stringify({type:"init"}),"https://cdn.poynt.net",[_this.iFrameMessageChannel])};document.body.appendChild(_this.iFrame)});return _context.abrupt("return",this.loadingPromise=promise);case 5:case"end":return _context.stop()}},_callee,this)}))}},{key:"postMessage",value:function postMessage(requestEvent,reponseSuccessEvent,responseFailEvent,options){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee2(){var _this2=this;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",new Promise(function(resolve,reject){var _a,_b,_c,_d;var onComplete=function onComplete(){var _a;console.log("[debug] Wallet API Request - Completed posting message",requestEvent);clearTimeout(timeout);(_a=_this2.originMessageChannel)===null||_a===void 0?void 0:_a.removeEventListener("message",eventListener)};var timeout=setTimeout(function(){console.log("[debug] Wallet API Request - Timeout posting message",requestEvent);onComplete();reject(new Error("Timeout posting message ".concat(requestEvent)))},constants_1.DEFAULT_TIMEOUT);var eventListener=function eventListener(event){var message=(0,common_1.parseMessage)(event);console.log("[debug] Wallet API Request - Received message",message===null||message===void 0?void 0:message.type);if((message===null||message===void 0?void 0:message.type)===reponseSuccessEvent){onComplete();return resolve(message.data)}if((message===null||message===void 0?void 0:message.type)===responseFailEvent){onComplete();return reject(message.data)}};(_a=_this2.originMessageChannel)===null||_a===void 0?void 0:_a.addEventListener("message",eventListener);console.log("[debug] Wallet API Request -  Posting message",requestEvent,!!((_b=_this2.iFrame)===null||_b===void 0?void 0:_b.contentWindow));(_d=(_c=_this2.iFrame)===null||_c===void 0?void 0:_c.contentWindow)===null||_d===void 0?void 0:_d.postMessage(JSON.stringify({type:requestEvent,options:options}),"https://cdn.poynt.net")}));case 1:case"end":return _context2.stop()}},_callee2)}))}},{key:"unmount",value:function unmount(){var _a,_b;console.log("[debug] Wallet API - Unmounting wallet API iFrame");if(this.messageChannel){(_a=this.originMessageChannel)===null||_a===void 0?void 0:_a.close();(_b=this.iFrameMessageChannel)===null||_b===void 0?void 0:_b.close();this.originMessageChannel=null;this.iFrameMessageChannel=null;this.messageChannel=null}if(this.iFrame&&document.body.contains(this.iFrame)){document.body.removeChild(this.iFrame)}this.iFrame=null;this.loaded=false}},{key:"mountAndPostMessage",value:function mountAndPostMessage(requestEvent,reponseSuccessEvent,responseFailEvent,options){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(this.isMounted()){_context3.next=3;break}_context3.next=3;return this.mount();case 3:return _context3.abrupt("return",this.postMessage(requestEvent,reponseSuccessEvent,responseFailEvent,options));case 4:case"end":return _context3.stop()}},_callee3,this)}))}},{key:"validateApplePay",value:function validateApplePay(options){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.abrupt("return",this.mountAndPostMessage("op_validate_applepay","validate_applepay","validate_applepay_error",options));case 1:case"end":return _context4.stop()}},_callee4,this)}))}},{key:"validateGooglePay",value:function validateGooglePay(options){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee5(){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _context5.abrupt("return",this.mountAndPostMessage("op_validate_googlepay","validate_googlepay","validate_googlepay_error",options));case 1:case"end":return _context5.stop()}},_callee5,this)}))}},{key:"getWalletNonce",value:function getWalletNonce(options){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark(function _callee6(){return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _context6.abrupt("return",this.mountAndPostMessage("op_get_wallet_nonce","wallet_nonce","wallet_nonce_error",options));case 1:case"end":return _context6.stop()}},_callee6,this)}))}}])}();exports["default"]=WalletApi},{"../constants":67,"../helpers/common":70}]},{},[64]);
